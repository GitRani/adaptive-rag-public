[2025-05-26 13:55:11,912][DEBUG][Starting new HTTPS connection (1): api.smith.langchain.com:443]
[2025-05-26 13:55:11,988][DEBUG][Request options: {'method': 'post', 'url': '/v1/messages', 'files': None, 'idempotency_key': 'stainless-python-retry-8150d46f-717a-494b-ae7f-ed946cbb7ad2', 'json_data': {'max_tokens': 1024, 'messages': [{'role': 'user', 'content': '안녕'}], 'model': 'claude-3-5-sonnet-20240620', 'system': "당신은 사용자 질문을 vector(벡터) 또는 search(웹 검색) 또는 generate(답변 생성)으로 라우팅하는 전문가입니다.\n- vector에는 '지방자치단체의 산안법 적용'과 관련된 문서가 포함되어 있습니다．이러한 주제에 대한 질문은 vector(벡터)를 routing하세요.\n- 일상적인 질문을 하는 경우, generate(답변 생성)으로 routing하세요.\n- 이 외의 검색이 필요한 질문의 경우, search(웹 검색)으로 routing하세요.\n", 'temperature': 0.0, 'tool_choice': {'type': 'tool', 'name': 'RouteQuery'}, 'tools': [{'name': 'RouteQuery', 'input_schema': {'properties': {'next_node': {'description': 'web_search/retrieve/generate 노드로 갈 지 질문을 보고 선택합니다.', 'enum': ['search', 'vector', 'generate'], 'type': 'string'}}, 'required': ['next_node'], 'type': 'object'}, 'description': '질문을 보고 가장 적합한 노드로 이동시킵니다.'}]}}]
[2025-05-26 13:55:11,989][DEBUG][Sending HTTP Request: POST https://api.anthropic.com/v1/messages]
[2025-05-26 13:55:11,989][DEBUG][connect_tcp.started host='api.anthropic.com' port=443 local_address=None timeout=None socket_options=[(65535, 8, True), (6, 257, 60), (6, 258, 5)]]
[2025-05-26 13:55:12,013][DEBUG][connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x11bc36490>]
[2025-05-26 13:55:12,013][DEBUG][start_tls.started ssl_context=<ssl.SSLContext object at 0x11b94bbf0> server_hostname='api.anthropic.com' timeout=None]
[2025-05-26 13:55:12,030][DEBUG][start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x11bc78c10>]
[2025-05-26 13:55:12,031][DEBUG][send_request_headers.started request=<Request [b'POST']>]
[2025-05-26 13:55:12,031][DEBUG][send_request_headers.complete]
[2025-05-26 13:55:12,031][DEBUG][send_request_body.started request=<Request [b'POST']>]
[2025-05-26 13:55:12,031][DEBUG][send_request_body.complete]
[2025-05-26 13:55:12,031][DEBUG][receive_response_headers.started request=<Request [b'POST']>]
[2025-05-26 13:55:12,216][DEBUG][https://api.smith.langchain.com:443 "GET /info HTTP/1.1" 200 709]
[2025-05-26 13:55:12,276][DEBUG][Sending multipart request with context: trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=d23b1f2d-0c44-43d7-8fa4-7788663989f7; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=fdbd0f28-b0a1-423b-9b77-2b1d69c69d0b; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=a79dc62d-c93b-4c9f-b71e-56e67197065b; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=0657941b-fd38-4417-8b5b-fef1f4a5dcf5; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=bcbd7b83-541a-4da0-9210-72892cefcfe1; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=45bba604-c93a-42f9-84c0-a12f34b3122a]
[2025-05-26 13:55:12,498][DEBUG][https://api.smith.langchain.com:443 "POST /runs/multipart HTTP/1.1" 202 34]
[2025-05-26 13:55:13,328][DEBUG][receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 26 May 2025 04:55:13 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'anthropic-ratelimit-input-tokens-limit', b'20000'), (b'anthropic-ratelimit-input-tokens-remaining', b'19000'), (b'anthropic-ratelimit-input-tokens-reset', b'2025-05-26T04:55:14Z'), (b'anthropic-ratelimit-output-tokens-limit', b'4000'), (b'anthropic-ratelimit-output-tokens-remaining', b'4000'), (b'anthropic-ratelimit-output-tokens-reset', b'2025-05-26T04:55:13Z'), (b'anthropic-ratelimit-requests-limit', b'5'), (b'anthropic-ratelimit-requests-remaining', b'4'), (b'anthropic-ratelimit-requests-reset', b'2025-05-26T04:55:24Z'), (b'anthropic-ratelimit-tokens-limit', b'24000'), (b'anthropic-ratelimit-tokens-remaining', b'23000'), (b'anthropic-ratelimit-tokens-reset', b'2025-05-26T04:55:13Z'), (b'request-id', b'req_011CPVYcLVJtAd7pTdrpWVNN'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'anthropic-organization-id', b'22e5ed16-15d8-4ef0-a72f-fd41275bf557'), (b'via', b'1.1 google'), (b'cf-cache-status', b'DYNAMIC'), (b'X-Robots-Tag', b'none'), (b'Server', b'cloudflare'), (b'CF-RAY', b'945aadcc3f36d1e2-ICN'), (b'Content-Encoding', b'gzip')])]
[2025-05-26 13:55:13,331][DEBUG][receive_response_body.started request=<Request [b'POST']>]
[2025-05-26 13:55:13,331][DEBUG][receive_response_body.complete]
[2025-05-26 13:55:13,331][DEBUG][response_closed.started]
[2025-05-26 13:55:13,331][DEBUG][response_closed.complete]
[2025-05-26 13:55:13,332][DEBUG][HTTP Response: POST https://api.anthropic.com/v1/messages "200 OK" Headers({'date': 'Mon, 26 May 2025 04:55:13 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'anthropic-ratelimit-input-tokens-limit': '20000', 'anthropic-ratelimit-input-tokens-remaining': '19000', 'anthropic-ratelimit-input-tokens-reset': '2025-05-26T04:55:14Z', 'anthropic-ratelimit-output-tokens-limit': '4000', 'anthropic-ratelimit-output-tokens-remaining': '4000', 'anthropic-ratelimit-output-tokens-reset': '2025-05-26T04:55:13Z', 'anthropic-ratelimit-requests-limit': '5', 'anthropic-ratelimit-requests-remaining': '4', 'anthropic-ratelimit-requests-reset': '2025-05-26T04:55:24Z', 'anthropic-ratelimit-tokens-limit': '24000', 'anthropic-ratelimit-tokens-remaining': '23000', 'anthropic-ratelimit-tokens-reset': '2025-05-26T04:55:13Z', 'request-id': 'req_011CPVYcLVJtAd7pTdrpWVNN', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'anthropic-organization-id': '22e5ed16-15d8-4ef0-a72f-fd41275bf557', 'via': '1.1 google', 'cf-cache-status': 'DYNAMIC', 'x-robots-tag': 'none', 'server': 'cloudflare', 'cf-ray': '945aadcc3f36d1e2-ICN', 'content-encoding': 'gzip'})]
[2025-05-26 13:55:13,332][DEBUG][request_id: req_011CPVYcLVJtAd7pTdrpWVNN]
[2025-05-26 13:55:13,369][DEBUG][Request options: {'method': 'post', 'url': '/v1/messages', 'files': None, 'idempotency_key': 'stainless-python-retry-0c62aa3f-5585-4f0b-932e-9780d63c9004', 'json_data': {'max_tokens': 1024, 'messages': [{'role': 'user', 'content': '당신은 질문-응답(QA) 작업을 전문으로 하는 AI 어시스턴트입니다. \n여러분의 주요 임무는 제공된 context 또는 채팅 기록을 기반으로 질문에 답변하는 것입니다.\n추가적인 내레이션 없이 간결하고 질문에 직접적으로 답변해야 합니다.\n\n###\n\n최종 답변은 간결하게 작성하되 중요한 숫자 값, 기술 용어, 전문 용어 및 이름을 포함해야 하며, 그 뒤에 정보의 출처를 적어야 합니다.\n\n# 단계\n\n1. 제공된 문맥을 주의 깊게 읽고 이해합니다.\n2. 문맥 내에서 질문과 관련된 핵심 정보를 파악합니다.\n3. 관련 정보를 바탕으로 간결하게 답안을 작성합니다.\n4. 최종 답변이 질문과 직접적으로 관련이 있는지 확인합니다.\n5. 답변의 출처를 글머리 기호로 나열하며, 파일 이름(페이지 번호 포함) 또는 문맥에 따른 URL이어야 합니다. 소스를 찾을 수 없는 경우 생략합니다.\n\n# 출력 형식:\n[최종 답안, 여기에 숫자 값, 전문 용어, 전문 용어 및 이름을 원래 언어로 입력]\n\n**출처**(선택 사항)\n- (답변의 출처는 문맥에서 파일 이름(페이지 번호 포함) 또는 URL이어야 합니다. 답안의 출처를 찾을 수 없는 경우 생략).\n- (출처가 여러 개 있는 경우 더 나열)\n- ...\n\n###\n\n기억하세요:\n- 오직 **제공된 문맥**에 근거하여 답안을 작성하는 것이 중요합니다.\n- 주어진 자료에 없는 외부 지식이나 정보를 사용하지 마세요.\n- 답의 출처를 찾을 수 없는 경우 "죄송합니다. 다른 질문을 해주세요." 답해야 합니다.\n- 단, 질문이 일상적인 대화인 경우 답해줘도 괜찮습니다. (예시: 안녕, 누구세요, 반가워 등)\n\n\n###\n\n# 다음은 여러분이 답해야 하는 사용자의 질문입니다:\n안녕\n\n# 다음은 질문에 답변할 때 사용해야 하는 컨텍스트입니다:\n\n\n# 사용자의 질문에 대한 최종 답변입니다:\n'}], 'model': 'claude-3-5-sonnet-20240620', 'temperature': 0.0}}]
[2025-05-26 13:55:13,370][DEBUG][Sending HTTP Request: POST https://api.anthropic.com/v1/messages]
[2025-05-26 13:55:13,370][DEBUG][connect_tcp.started host='api.anthropic.com' port=443 local_address=None timeout=None socket_options=[(65535, 8, True), (6, 257, 60), (6, 258, 5)]]
[2025-05-26 13:55:13,387][DEBUG][connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x11bd5e190>]
[2025-05-26 13:55:13,387][DEBUG][start_tls.started ssl_context=<ssl.SSLContext object at 0x11bd18c20> server_hostname='api.anthropic.com' timeout=None]
[2025-05-26 13:55:13,399][DEBUG][start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x11bd5e150>]
[2025-05-26 13:55:13,399][DEBUG][send_request_headers.started request=<Request [b'POST']>]
[2025-05-26 13:55:13,399][DEBUG][send_request_headers.complete]
[2025-05-26 13:55:13,399][DEBUG][send_request_body.started request=<Request [b'POST']>]
[2025-05-26 13:55:13,399][DEBUG][send_request_body.complete]
[2025-05-26 13:55:13,399][DEBUG][receive_response_headers.started request=<Request [b'POST']>]
[2025-05-26 13:55:13,901][DEBUG][Sending compressed multipart request with context: trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=45bba604-c93a-42f9-84c0-a12f34b3122a; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=635b148d-0341-4b8a-b260-32bf98d546de; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=635b148d-0341-4b8a-b260-32bf98d546de; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=0657941b-fd38-4417-8b5b-fef1f4a5dcf5; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=a79dc62d-c93b-4c9f-b71e-56e67197065b; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=fdbd0f28-b0a1-423b-9b77-2b1d69c69d0b; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=2aaeb527-afa9-42e1-9c88-86f18d303ba6; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=25368c78-64a5-450c-8d56-4675a15f6cf6; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=fdc5350a-7542-4621-bb33-2865702f3831; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=fdc5350a-7542-4621-bb33-2865702f3831; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=6a4d788d-39b1-484f-888d-12a65103e50f]
[2025-05-26 13:55:14,124][DEBUG][https://api.smith.langchain.com:443 "POST /runs/multipart HTTP/1.1" 202 34]
[2025-05-26 13:55:14,455][DEBUG][receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 26 May 2025 04:55:14 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'anthropic-ratelimit-input-tokens-limit', b'20000'), (b'anthropic-ratelimit-input-tokens-remaining', b'19000'), (b'anthropic-ratelimit-input-tokens-reset', b'2025-05-26T04:55:17Z'), (b'anthropic-ratelimit-output-tokens-limit', b'4000'), (b'anthropic-ratelimit-output-tokens-remaining', b'4000'), (b'anthropic-ratelimit-output-tokens-reset', b'2025-05-26T04:55:14Z'), (b'anthropic-ratelimit-requests-limit', b'5'), (b'anthropic-ratelimit-requests-remaining', b'3'), (b'anthropic-ratelimit-requests-reset', b'2025-05-26T04:55:36Z'), (b'anthropic-ratelimit-tokens-limit', b'24000'), (b'anthropic-ratelimit-tokens-remaining', b'23000'), (b'anthropic-ratelimit-tokens-reset', b'2025-05-26T04:55:14Z'), (b'request-id', b'req_011CPVYcSKYpagxanB1cNHYE'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'anthropic-organization-id', b'22e5ed16-15d8-4ef0-a72f-fd41275bf557'), (b'via', b'1.1 google'), (b'cf-cache-status', b'DYNAMIC'), (b'X-Robots-Tag', b'none'), (b'Server', b'cloudflare'), (b'CF-RAY', b'945aadd4baf4ea17-ICN'), (b'Content-Encoding', b'gzip')])]
[2025-05-26 13:55:14,457][DEBUG][receive_response_body.started request=<Request [b'POST']>]
[2025-05-26 13:55:14,462][DEBUG][receive_response_body.complete]
[2025-05-26 13:55:14,463][DEBUG][response_closed.started]
[2025-05-26 13:55:14,463][DEBUG][response_closed.complete]
[2025-05-26 13:55:14,463][DEBUG][HTTP Response: POST https://api.anthropic.com/v1/messages "200 OK" Headers({'date': 'Mon, 26 May 2025 04:55:14 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'anthropic-ratelimit-input-tokens-limit': '20000', 'anthropic-ratelimit-input-tokens-remaining': '19000', 'anthropic-ratelimit-input-tokens-reset': '2025-05-26T04:55:17Z', 'anthropic-ratelimit-output-tokens-limit': '4000', 'anthropic-ratelimit-output-tokens-remaining': '4000', 'anthropic-ratelimit-output-tokens-reset': '2025-05-26T04:55:14Z', 'anthropic-ratelimit-requests-limit': '5', 'anthropic-ratelimit-requests-remaining': '3', 'anthropic-ratelimit-requests-reset': '2025-05-26T04:55:36Z', 'anthropic-ratelimit-tokens-limit': '24000', 'anthropic-ratelimit-tokens-remaining': '23000', 'anthropic-ratelimit-tokens-reset': '2025-05-26T04:55:14Z', 'request-id': 'req_011CPVYcSKYpagxanB1cNHYE', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'anthropic-organization-id': '22e5ed16-15d8-4ef0-a72f-fd41275bf557', 'via': '1.1 google', 'cf-cache-status': 'DYNAMIC', 'x-robots-tag': 'none', 'server': 'cloudflare', 'cf-ray': '945aadd4baf4ea17-ICN', 'content-encoding': 'gzip'})]
[2025-05-26 13:55:14,464][DEBUG][request_id: req_011CPVYcSKYpagxanB1cNHYE]
[2025-05-26 13:55:14,479][DEBUG][close.started]
[2025-05-26 13:55:14,480][DEBUG][close.complete]
[2025-05-26 13:55:14,496][DEBUG][Request options: {'method': 'post', 'url': '/v1/messages', 'files': None, 'idempotency_key': 'stainless-python-retry-835bf43d-0ff0-4a4a-b4da-1ab61c11960b', 'json_data': {'max_tokens': 1024, 'messages': [{'role': 'user', 'content': 'Set of facts: \n\n  \n\n LLM generation: 안녕하세요. 무엇을 도와드릴까요?'}], 'model': 'claude-3-5-sonnet-20240620', 'system': "채점자는 생성된 LLM 답변이 검색된 일련의 사실에 근거/지원되는지 평가하는 채점자입니다. \\n \n'Y' 또는 'N'으로 이진 점수를 부여합니다. 'Y'는 답변이 일련의 사실에 근거하거나 사실에 의해 뒷받침된다는 의미입니다.\n", 'temperature': 0.0, 'tool_choice': {'type': 'tool', 'name': 'GradeHallucinations'}, 'tools': [{'name': 'GradeHallucinations', 'input_schema': {'properties': {'pass_yn': {'description': "생성된 답변이 사실인지에 따라 'Y' 또는 'N' 로 답합니다.", 'enum': ['Y', 'N'], 'type': 'string'}}, 'required': ['pass_yn'], 'type': 'object'}, 'description': '생성된 답변이 hallucination 현상이 있는지에 대한 여부를 판단합니다. '}]}}]
[2025-05-26 13:55:14,496][DEBUG][Sending HTTP Request: POST https://api.anthropic.com/v1/messages]
[2025-05-26 13:55:14,497][DEBUG][connect_tcp.started host='api.anthropic.com' port=443 local_address=None timeout=None socket_options=[(65535, 8, True), (6, 257, 60), (6, 258, 5)]]
[2025-05-26 13:55:14,507][DEBUG][connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x11bc24050>]
[2025-05-26 13:55:14,507][DEBUG][start_tls.started ssl_context=<ssl.SSLContext object at 0x11bd18710> server_hostname='api.anthropic.com' timeout=None]
[2025-05-26 13:55:14,519][DEBUG][start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x11bd5df10>]
[2025-05-26 13:55:14,519][DEBUG][send_request_headers.started request=<Request [b'POST']>]
[2025-05-26 13:55:14,519][DEBUG][send_request_headers.complete]
[2025-05-26 13:55:14,519][DEBUG][send_request_body.started request=<Request [b'POST']>]
[2025-05-26 13:55:14,519][DEBUG][send_request_body.complete]
[2025-05-26 13:55:14,519][DEBUG][receive_response_headers.started request=<Request [b'POST']>]
[2025-05-26 13:55:15,031][DEBUG][Sending compressed multipart request with context: trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=6a4d788d-39b1-484f-888d-12a65103e50f; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=8456aafd-d5a5-48b0-9641-2279c12b749a; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=8456aafd-d5a5-48b0-9641-2279c12b749a; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=25368c78-64a5-450c-8d56-4675a15f6cf6; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=392cfb7f-6f84-4698-9502-a4bca3f10875; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=cade7ab0-cf7b-44ae-8715-83bcb06b869a; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=17660033-7271-456d-a25a-5c3a6966b4e7; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=17660033-7271-456d-a25a-5c3a6966b4e7; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=6a8e49e5-011e-4665-b478-5d041f05130e]
[2025-05-26 13:55:15,251][DEBUG][https://api.smith.langchain.com:443 "POST /runs/multipart HTTP/1.1" 202 34]
[2025-05-26 13:55:15,491][DEBUG][receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 26 May 2025 04:55:15 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'anthropic-ratelimit-input-tokens-limit', b'20000'), (b'anthropic-ratelimit-input-tokens-remaining', b'19000'), (b'anthropic-ratelimit-input-tokens-reset', b'2025-05-26T04:55:19Z'), (b'anthropic-ratelimit-output-tokens-limit', b'4000'), (b'anthropic-ratelimit-output-tokens-remaining', b'4000'), (b'anthropic-ratelimit-output-tokens-reset', b'2025-05-26T04:55:15Z'), (b'anthropic-ratelimit-requests-limit', b'5'), (b'anthropic-ratelimit-requests-remaining', b'2'), (b'anthropic-ratelimit-requests-reset', b'2025-05-26T04:55:48Z'), (b'anthropic-ratelimit-tokens-limit', b'24000'), (b'anthropic-ratelimit-tokens-remaining', b'23000'), (b'anthropic-ratelimit-tokens-reset', b'2025-05-26T04:55:15Z'), (b'request-id', b'req_011CPVYcX7n6jYGRLGCAr5Np'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'anthropic-organization-id', b'22e5ed16-15d8-4ef0-a72f-fd41275bf557'), (b'via', b'1.1 google'), (b'cf-cache-status', b'DYNAMIC'), (b'X-Robots-Tag', b'none'), (b'Server', b'cloudflare'), (b'CF-RAY', b'945aaddbc8d2e9fb-ICN'), (b'Content-Encoding', b'gzip')])]
[2025-05-26 13:55:15,493][DEBUG][receive_response_body.started request=<Request [b'POST']>]
[2025-05-26 13:55:15,494][DEBUG][receive_response_body.complete]
[2025-05-26 13:55:15,494][DEBUG][response_closed.started]
[2025-05-26 13:55:15,494][DEBUG][response_closed.complete]
[2025-05-26 13:55:15,494][DEBUG][HTTP Response: POST https://api.anthropic.com/v1/messages "200 OK" Headers({'date': 'Mon, 26 May 2025 04:55:15 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'anthropic-ratelimit-input-tokens-limit': '20000', 'anthropic-ratelimit-input-tokens-remaining': '19000', 'anthropic-ratelimit-input-tokens-reset': '2025-05-26T04:55:19Z', 'anthropic-ratelimit-output-tokens-limit': '4000', 'anthropic-ratelimit-output-tokens-remaining': '4000', 'anthropic-ratelimit-output-tokens-reset': '2025-05-26T04:55:15Z', 'anthropic-ratelimit-requests-limit': '5', 'anthropic-ratelimit-requests-remaining': '2', 'anthropic-ratelimit-requests-reset': '2025-05-26T04:55:48Z', 'anthropic-ratelimit-tokens-limit': '24000', 'anthropic-ratelimit-tokens-remaining': '23000', 'anthropic-ratelimit-tokens-reset': '2025-05-26T04:55:15Z', 'request-id': 'req_011CPVYcX7n6jYGRLGCAr5Np', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'anthropic-organization-id': '22e5ed16-15d8-4ef0-a72f-fd41275bf557', 'via': '1.1 google', 'cf-cache-status': 'DYNAMIC', 'x-robots-tag': 'none', 'server': 'cloudflare', 'cf-ray': '945aaddbc8d2e9fb-ICN', 'content-encoding': 'gzip'})]
[2025-05-26 13:55:15,495][DEBUG][request_id: req_011CPVYcX7n6jYGRLGCAr5Np]
[2025-05-26 13:55:15,525][DEBUG][Request options: {'method': 'post', 'url': '/v1/messages', 'files': None, 'idempotency_key': 'stainless-python-retry-80cfe810-0d13-4052-8e75-961226e77e36', 'json_data': {'max_tokens': 1024, 'messages': [{'role': 'user', 'content': 'User question: \n\n 안녕 \n\n LLM generation: 안녕하세요. 무엇을 도와드릴까요?'}], 'model': 'claude-3-5-sonnet-20240620', 'system': "당신은 제공된 답변이 질문과 관련 있는지 평가하는 채점자입니다.\n'Y' 또는 'N'로 이진 점수를 부여합니다. \n'Y'는 답변이 질문과 관련이 있음을 의미합니다.\n예외사항) 제공된 답변이 '정보를 찾을 수 없다는' 의미의 답변이라면 'Y'를 부여하세요.\n", 'temperature': 0.0, 'tool_choice': {'type': 'tool', 'name': 'GradeQuestionAnswer'}, 'tools': [{'name': 'GradeQuestionAnswer', 'input_schema': {'properties': {'pass_yn': {'description': "답변이 질문을 해결할 수 있는 지에 따라 'Y' 또는 'N' 로 답합니다.", 'enum': ['Y', 'N'], 'type': 'string'}}, 'required': ['pass_yn'], 'type': 'object'}, 'description': '생성된 답변이 질문과 관련이 있는지에 대한 여부를 판단합니다.'}]}}]
[2025-05-26 13:55:15,525][DEBUG][Sending HTTP Request: POST https://api.anthropic.com/v1/messages]
[2025-05-26 13:55:15,525][DEBUG][connect_tcp.started host='api.anthropic.com' port=443 local_address=None timeout=None socket_options=[(65535, 8, True), (6, 257, 60), (6, 258, 5)]]
[2025-05-26 13:55:15,543][DEBUG][connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x11bd5da50>]
[2025-05-26 13:55:15,543][DEBUG][start_tls.started ssl_context=<ssl.SSLContext object at 0x11bd18ef0> server_hostname='api.anthropic.com' timeout=None]
[2025-05-26 13:55:15,590][DEBUG][start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x11bd759d0>]
[2025-05-26 13:55:15,595][DEBUG][send_request_headers.started request=<Request [b'POST']>]
[2025-05-26 13:55:15,600][DEBUG][send_request_headers.complete]
[2025-05-26 13:55:15,600][DEBUG][send_request_body.started request=<Request [b'POST']>]
[2025-05-26 13:55:15,601][DEBUG][send_request_body.complete]
[2025-05-26 13:55:15,602][DEBUG][receive_response_headers.started request=<Request [b'POST']>]
[2025-05-26 13:55:16,057][DEBUG][Sending compressed multipart request with context: trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=6a8e49e5-011e-4665-b478-5d041f05130e; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=0f1fc70a-a661-4072-bb48-bf923662904c; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=0f1fc70a-a661-4072-bb48-bf923662904c; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=cade7ab0-cf7b-44ae-8715-83bcb06b869a; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=c4035c60-0bf7-4798-bb6c-e26e7cceb686; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=ec9d1eb6-a11c-4e5d-b0c3-f5c766f884e5; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=ec9d1eb6-a11c-4e5d-b0c3-f5c766f884e5; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=b368bb7a-e562-4db4-8cf1-a71a363222b6]
[2025-05-26 13:55:16,058][DEBUG][close.started]
[2025-05-26 13:55:16,058][DEBUG][close.complete]
[2025-05-26 13:55:16,296][DEBUG][https://api.smith.langchain.com:443 "POST /runs/multipart HTTP/1.1" 202 34]
[2025-05-26 13:55:16,613][DEBUG][receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 26 May 2025 04:55:16 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'anthropic-ratelimit-input-tokens-limit', b'20000'), (b'anthropic-ratelimit-input-tokens-remaining', b'18000'), (b'anthropic-ratelimit-input-tokens-reset', b'2025-05-26T04:55:21Z'), (b'anthropic-ratelimit-output-tokens-limit', b'4000'), (b'anthropic-ratelimit-output-tokens-remaining', b'4000'), (b'anthropic-ratelimit-output-tokens-reset', b'2025-05-26T04:55:16Z'), (b'anthropic-ratelimit-requests-limit', b'5'), (b'anthropic-ratelimit-requests-remaining', b'1'), (b'anthropic-ratelimit-requests-reset', b'2025-05-26T04:56:00Z'), (b'anthropic-ratelimit-tokens-limit', b'24000'), (b'anthropic-ratelimit-tokens-remaining', b'22000'), (b'anthropic-ratelimit-tokens-reset', b'2025-05-26T04:55:16Z'), (b'request-id', b'req_011CPVYcbibbCRYPjCT6tevG'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'anthropic-organization-id', b'22e5ed16-15d8-4ef0-a72f-fd41275bf557'), (b'via', b'1.1 google'), (b'cf-cache-status', b'DYNAMIC'), (b'X-Robots-Tag', b'none'), (b'Server', b'cloudflare'), (b'CF-RAY', b'945aade28df2ea12-ICN'), (b'Content-Encoding', b'gzip')])]
[2025-05-26 13:55:16,614][DEBUG][receive_response_body.started request=<Request [b'POST']>]
[2025-05-26 13:55:16,615][DEBUG][receive_response_body.complete]
[2025-05-26 13:55:16,615][DEBUG][response_closed.started]
[2025-05-26 13:55:16,615][DEBUG][response_closed.complete]
[2025-05-26 13:55:16,615][DEBUG][HTTP Response: POST https://api.anthropic.com/v1/messages "200 OK" Headers({'date': 'Mon, 26 May 2025 04:55:16 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'anthropic-ratelimit-input-tokens-limit': '20000', 'anthropic-ratelimit-input-tokens-remaining': '18000', 'anthropic-ratelimit-input-tokens-reset': '2025-05-26T04:55:21Z', 'anthropic-ratelimit-output-tokens-limit': '4000', 'anthropic-ratelimit-output-tokens-remaining': '4000', 'anthropic-ratelimit-output-tokens-reset': '2025-05-26T04:55:16Z', 'anthropic-ratelimit-requests-limit': '5', 'anthropic-ratelimit-requests-remaining': '1', 'anthropic-ratelimit-requests-reset': '2025-05-26T04:56:00Z', 'anthropic-ratelimit-tokens-limit': '24000', 'anthropic-ratelimit-tokens-remaining': '22000', 'anthropic-ratelimit-tokens-reset': '2025-05-26T04:55:16Z', 'request-id': 'req_011CPVYcbibbCRYPjCT6tevG', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'anthropic-organization-id': '22e5ed16-15d8-4ef0-a72f-fd41275bf557', 'via': '1.1 google', 'cf-cache-status': 'DYNAMIC', 'x-robots-tag': 'none', 'server': 'cloudflare', 'cf-ray': '945aade28df2ea12-ICN', 'content-encoding': 'gzip'})]
[2025-05-26 13:55:16,616][DEBUG][request_id: req_011CPVYcbibbCRYPjCT6tevG]
[2025-05-26 13:55:16,637][DEBUG][Request options: {'method': 'post', 'url': '/v1/messages', 'files': None, 'idempotency_key': 'stainless-python-retry-b2d7accf-f7bb-4c43-8113-5d9aedf43d3b', 'json_data': {'max_tokens': 1024, 'messages': [{'role': 'user', 'content': '안녕'}], 'model': 'claude-3-5-sonnet-20240620', 'system': '입력된 질문을 벡터 검색에 최적화된 더 나은 버전으로 변환하는 질문 재작성기입니다. 입력을 보고 근본적인 의미론적 의도/의미에 대해 추론해서 질문을 다시 작성해주세요.\n다른 내용은 생성하지 말고 수정된 질문만 생성해주세요.', 'temperature': 0.0}}]
[2025-05-26 13:55:16,638][DEBUG][Sending HTTP Request: POST https://api.anthropic.com/v1/messages]
[2025-05-26 13:55:16,639][DEBUG][connect_tcp.started host='api.anthropic.com' port=443 local_address=None timeout=None socket_options=[(65535, 8, True), (6, 257, 60), (6, 258, 5)]]
[2025-05-26 13:55:16,649][DEBUG][connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x11bd77c50>]
[2025-05-26 13:55:16,649][DEBUG][start_tls.started ssl_context=<ssl.SSLContext object at 0x11bd18710> server_hostname='api.anthropic.com' timeout=None]
[2025-05-26 13:55:16,665][DEBUG][start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x11bd77c10>]
[2025-05-26 13:55:16,665][DEBUG][send_request_headers.started request=<Request [b'POST']>]
[2025-05-26 13:55:16,665][DEBUG][send_request_headers.complete]
[2025-05-26 13:55:16,666][DEBUG][send_request_body.started request=<Request [b'POST']>]
[2025-05-26 13:55:16,666][DEBUG][send_request_body.complete]
[2025-05-26 13:55:16,666][DEBUG][receive_response_headers.started request=<Request [b'POST']>]
[2025-05-26 13:55:17,148][DEBUG][Sending compressed multipart request with context: trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=b368bb7a-e562-4db4-8cf1-a71a363222b6; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=d40c7dc2-e916-4c7e-842b-b833777ff6d9; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=d40c7dc2-e916-4c7e-842b-b833777ff6d9; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=c4035c60-0bf7-4798-bb6c-e26e7cceb686; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=392cfb7f-6f84-4698-9502-a4bca3f10875; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=2aaeb527-afa9-42e1-9c88-86f18d303ba6; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=bcc9d04e-89de-4db3-91aa-ae094b862c77; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=6e68b49a-2a8c-4e18-a97e-f938586900c5; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=2f9708e3-38ac-48ee-ae34-64f4f1e23395; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=2f9708e3-38ac-48ee-ae34-64f4f1e23395; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=af4df5a3-dda4-49d6-8279-2d9f99270b02]
[2025-05-26 13:55:17,380][DEBUG][https://api.smith.langchain.com:443 "POST /runs/multipart HTTP/1.1" 202 34]
[2025-05-26 13:55:17,981][DEBUG][receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 26 May 2025 04:55:17 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'anthropic-ratelimit-input-tokens-limit', b'20000'), (b'anthropic-ratelimit-input-tokens-remaining', b'18000'), (b'anthropic-ratelimit-input-tokens-reset', b'2025-05-26T04:55:22Z'), (b'anthropic-ratelimit-output-tokens-limit', b'4000'), (b'anthropic-ratelimit-output-tokens-remaining', b'4000'), (b'anthropic-ratelimit-output-tokens-reset', b'2025-05-26T04:55:17Z'), (b'anthropic-ratelimit-requests-limit', b'5'), (b'anthropic-ratelimit-requests-remaining', b'0'), (b'anthropic-ratelimit-requests-reset', b'2025-05-26T04:56:12Z'), (b'anthropic-ratelimit-tokens-limit', b'24000'), (b'anthropic-ratelimit-tokens-remaining', b'22000'), (b'anthropic-ratelimit-tokens-reset', b'2025-05-26T04:55:17Z'), (b'request-id', b'req_011CPVYcgJRpx3E9UXnojkDe'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'anthropic-organization-id', b'22e5ed16-15d8-4ef0-a72f-fd41275bf557'), (b'via', b'1.1 google'), (b'cf-cache-status', b'DYNAMIC'), (b'X-Robots-Tag', b'none'), (b'Server', b'cloudflare'), (b'CF-RAY', b'945aade929bcc449-ICN'), (b'Content-Encoding', b'gzip')])]
[2025-05-26 13:55:17,983][DEBUG][receive_response_body.started request=<Request [b'POST']>]
[2025-05-26 13:55:17,984][DEBUG][receive_response_body.complete]
[2025-05-26 13:55:17,984][DEBUG][response_closed.started]
[2025-05-26 13:55:17,984][DEBUG][response_closed.complete]
[2025-05-26 13:55:17,984][DEBUG][HTTP Response: POST https://api.anthropic.com/v1/messages "200 OK" Headers({'date': 'Mon, 26 May 2025 04:55:17 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'anthropic-ratelimit-input-tokens-limit': '20000', 'anthropic-ratelimit-input-tokens-remaining': '18000', 'anthropic-ratelimit-input-tokens-reset': '2025-05-26T04:55:22Z', 'anthropic-ratelimit-output-tokens-limit': '4000', 'anthropic-ratelimit-output-tokens-remaining': '4000', 'anthropic-ratelimit-output-tokens-reset': '2025-05-26T04:55:17Z', 'anthropic-ratelimit-requests-limit': '5', 'anthropic-ratelimit-requests-remaining': '0', 'anthropic-ratelimit-requests-reset': '2025-05-26T04:56:12Z', 'anthropic-ratelimit-tokens-limit': '24000', 'anthropic-ratelimit-tokens-remaining': '22000', 'anthropic-ratelimit-tokens-reset': '2025-05-26T04:55:17Z', 'request-id': 'req_011CPVYcgJRpx3E9UXnojkDe', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'anthropic-organization-id': '22e5ed16-15d8-4ef0-a72f-fd41275bf557', 'via': '1.1 google', 'cf-cache-status': 'DYNAMIC', 'x-robots-tag': 'none', 'server': 'cloudflare', 'cf-ray': '945aade929bcc449-ICN', 'content-encoding': 'gzip'})]
[2025-05-26 13:55:17,985][DEBUG][request_id: req_011CPVYcgJRpx3E9UXnojkDe]
[2025-05-26 13:55:18,000][DEBUG][close.started]
[2025-05-26 13:55:18,000][DEBUG][close.complete]
[2025-05-26 13:55:18,006][DEBUG][close.started]
[2025-05-26 13:55:18,006][DEBUG][close.complete]
[2025-05-26 13:55:18,006][DEBUG][close.started]
[2025-05-26 13:55:18,006][DEBUG][close.complete]
[2025-05-26 13:55:18,835][DEBUG][Sending compressed multipart request with context: trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=af4df5a3-dda4-49d6-8279-2d9f99270b02; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=6e68b49a-2a8c-4e18-a97e-f938586900c5; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=bcc9d04e-89de-4db3-91aa-ae094b862c77; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=590d1ba4-f547-4d6c-8013-5483f04f19fd]
[2025-05-26 13:55:19,056][DEBUG][https://api.smith.langchain.com:443 "POST /runs/multipart HTTP/1.1" 202 34]
[2025-05-26 13:55:24,241][DEBUG][Starting new HTTPS connection (1): huggingface.co:443]
[2025-05-26 13:55:24,500][DEBUG][https://huggingface.co:443 "HEAD /BAAI/bge-m3/resolve/main/modules.json HTTP/1.1" 200 0]
[2025-05-26 13:55:24,738][DEBUG][https://huggingface.co:443 "HEAD /BAAI/bge-m3/resolve/main/config_sentence_transformers.json HTTP/1.1" 200 0]
[2025-05-26 13:55:24,953][DEBUG][https://huggingface.co:443 "HEAD /BAAI/bge-m3/resolve/main/README.md HTTP/1.1" 200 0]
[2025-05-26 13:55:25,169][DEBUG][https://huggingface.co:443 "HEAD /BAAI/bge-m3/resolve/main/modules.json HTTP/1.1" 200 0]
[2025-05-26 13:55:25,378][DEBUG][https://huggingface.co:443 "HEAD /BAAI/bge-m3/resolve/main/sentence_bert_config.json HTTP/1.1" 200 0]
[2025-05-26 13:55:25,596][DEBUG][https://huggingface.co:443 "HEAD /BAAI/bge-m3/resolve/main/adapter_config.json HTTP/1.1" 404 0]
[2025-05-26 13:55:25,813][DEBUG][https://huggingface.co:443 "HEAD /BAAI/bge-m3/resolve/main/config.json HTTP/1.1" 200 0]
[2025-05-26 13:55:26,590][DEBUG][https://huggingface.co:443 "HEAD /BAAI/bge-m3/resolve/main/model.safetensors HTTP/1.1" 404 0]
[2025-05-26 13:55:26,596][DEBUG][Starting new HTTPS connection (1): huggingface.co:443]
[2025-05-26 13:55:27,216][DEBUG][https://huggingface.co:443 "GET /api/models/BAAI/bge-m3 HTTP/1.1" 200 5209]
[2025-05-26 13:55:27,477][DEBUG][https://huggingface.co:443 "GET /api/models/BAAI/bge-m3/commits/main HTTP/1.1" 200 9525]
[2025-05-26 13:55:27,745][DEBUG][https://huggingface.co:443 "GET /api/models/BAAI/bge-m3/discussions?p=0 HTTP/1.1" 200 30448]
[2025-05-26 13:55:27,943][DEBUG][https://huggingface.co:443 "HEAD /BAAI/bge-m3/resolve/main/tokenizer_config.json HTTP/1.1" 200 0]
[2025-05-26 13:55:27,996][DEBUG][https://huggingface.co:443 "GET /api/models/BAAI/bge-m3/commits/refs%2Fpr%2F118 HTTP/1.1" 200 10490]
[2025-05-26 13:55:28,167][DEBUG][https://huggingface.co:443 "GET /api/models/BAAI/bge-m3/tree/main/additional_chat_templates?recursive=False&expand=False HTTP/1.1" 404 64]
[2025-05-26 13:55:28,396][DEBUG][https://huggingface.co:443 "HEAD /BAAI/bge-m3/resolve/refs%2Fpr%2F118/model.safetensors.index.json HTTP/1.1" 404 0]
[2025-05-26 13:55:29,496][DEBUG][https://huggingface.co:443 "HEAD /BAAI/bge-m3/resolve/refs%2Fpr%2F118/model.safetensors HTTP/1.1" 302 0]
[2025-05-26 13:55:29,520][DEBUG][https://huggingface.co:443 "GET /api/models/BAAI/bge-m3/revision/main HTTP/1.1" 200 5209]
[2025-05-26 13:55:29,761][DEBUG][https://huggingface.co:443 "GET /api/models/BAAI/bge-m3 HTTP/1.1" 200 5209]
[2025-05-26 13:55:34,696][DEBUG][Environment variable FAISS_OPT_LEVEL is not set, so let's pick the instruction set according to the current CPU]
[2025-05-26 13:55:35,316][DEBUG][Request options: {'method': 'post', 'url': '/v1/messages', 'files': None, 'idempotency_key': 'stainless-python-retry-7cc78789-dbd1-4ee4-ab2d-7afab3a0c2e9', 'json_data': {'max_tokens': 1024, 'messages': [{'role': 'user', 'content': 'Retrieved document: \n\n page_content=\'되어 있더라도 출장소, 사업소, 지점 등이 업무처리 능력 등을 감안할 때\n하나의 사업장이라고 말할 정도의 독립성이 없으면 직근 상위조직(기구)와\n일괄하여 하나의 사업장으로 보아야 할 것임(산재예방정책과-7065, ‘12.7.30)\n□ 지방자치단체 산안법 적용 검토\n○ ｢한국표준산업분류｣에 따르면 공공행정은 일반 공공행정, 재정\n및 경제정책 행정, 정부기관 일반 보조 행정 등 행정에 관한 규제와\n집행을 위한 행정사무 업무만을 의미함\n- 지방자치단체가 행하는 일반 행정사무는 공공행정에 해당하므로\' metadata={\'source\': \'/Users/ranifarm/python-work/adaptive-rag/vectorstore/data/지방자치단체 산안법 적용 (산재예방정책과-3018 (2018.07.06. 시행).pdf\', \'file_path\': \'/Users/ranifarm/python-work/adaptive-rag/vectorstore/data/지방자치단체 산안법 적용 (산재예방정책과-3018 (2018.07.06. 시행).pdf\', \'page\': 0, \'total_pages\': 3, \'Author\': \'dw\', \'CreationDate\': "D:20241223160641+09\'00\'", \'Creator\': \'Hwp 2022 12.0.0.2416\', \'ModDate\': "D:20241223160641+09\'00\'", \'PDFVersion\': \'1.4\', \'Producer\': \'Hancom PDF 1.3.0.545\'} \n\n User question: content=\'인사와 대화 시작에 관한 일반적인 표현\' additional_kwargs={} response_metadata={\'id\': \'msg_014MxmkSScGAz17bz5ipdeET\', \'model\': \'claude-3-5-sonnet-20240620\', \'stop_reason\': \'end_turn\', \'stop_sequence\': None, \'usage\': {\'cache_creation_input_tokens\': 0, \'cache_read_input_tokens\': 0, \'input_tokens\': 136, \'output_tokens\': 25, \'server_tool_use\': None, \'service_tier\': \'standard\'}, \'model_name\': \'claude-3-5-sonnet-20240620\'} id=\'run--af4df5a3-dda4-49d6-8279-2d9f99270b02-0\' usage_metadata={\'input_tokens\': 136, \'output_tokens\': 25, \'total_tokens\': 161, \'input_token_details\': {\'cache_read\': 0, \'cache_creation\': 0}}'}], 'model': 'claude-3-5-sonnet-20240620', 'system': "채점자는 검색된 문서와 사용자 질문의 관련성을 평가하는 채점자입니다. \\n \n문서에 사용자 질문과 관련된 키워드 또는 의미론적 의미가 포함되어 있으면 관련성이 있는 것으로 채점합니다. \\n\n잘못된 검색을 걸러내는 것이 목표입니다. \\n\n문서가 질문으로 해결할 수 있는 내용인지 여부를 나타내는 이진 점수 'Y' 또는 'N'을 부여합니다.\n", 'temperature': 0.0, 'tool_choice': {'type': 'tool', 'name': 'GradeDocuments'}, 'tools': [{'name': 'GradeDocuments', 'input_schema': {'properties': {'pass_yn': {'description': "문서가 질문으로 해결 가능한 내용인지에 따라 'Y' 또는 'N' 로 답합니다.", 'enum': ['Y', 'N'], 'type': 'string'}}, 'required': ['pass_yn'], 'type': 'object'}, 'description': '검색된 문서가 질문으로 해결 가능한 내용인지에 대한 여부를 판단합니다.'}]}}]
[2025-05-26 13:55:35,318][DEBUG][Sending HTTP Request: POST https://api.anthropic.com/v1/messages]
[2025-05-26 13:55:35,318][DEBUG][connect_tcp.started host='api.anthropic.com' port=443 local_address=None timeout=None socket_options=[(65535, 8, True), (6, 257, 60), (6, 258, 5)]]
[2025-05-26 13:55:35,339][DEBUG][connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x306a50510>]
[2025-05-26 13:55:35,339][DEBUG][start_tls.started ssl_context=<ssl.SSLContext object at 0x3aef8e180> server_hostname='api.anthropic.com' timeout=None]
[2025-05-26 13:55:35,358][DEBUG][start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x306e57390>]
[2025-05-26 13:55:35,359][DEBUG][send_request_headers.started request=<Request [b'POST']>]
[2025-05-26 13:55:35,359][DEBUG][send_request_headers.complete]
[2025-05-26 13:55:35,359][DEBUG][send_request_body.started request=<Request [b'POST']>]
[2025-05-26 13:55:35,359][DEBUG][send_request_body.complete]
[2025-05-26 13:55:35,359][DEBUG][receive_response_headers.started request=<Request [b'POST']>]
[2025-05-26 13:55:35,839][DEBUG][Sending compressed multipart request with context: trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=a647dd09-a318-4adc-b915-b7103de49b73; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=a647dd09-a318-4adc-b915-b7103de49b73; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=590d1ba4-f547-4d6c-8013-5483f04f19fd; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=9c80865c-0a5d-4275-bfc1-820b5aee7470; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=959af524-1133-4d24-b4e7-4a14edc48efc; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=08da3aba-2083-4173-b2ec-e655243d257c; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=08da3aba-2083-4173-b2ec-e655243d257c; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=ed16e0ba-66d7-478f-a33d-43bfb475bb96]
[2025-05-26 13:55:36,080][DEBUG][https://api.smith.langchain.com:443 "POST /runs/multipart HTTP/1.1" 202 34]
[2025-05-26 13:55:36,549][DEBUG][receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 26 May 2025 04:55:36 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'anthropic-ratelimit-input-tokens-limit', b'20000'), (b'anthropic-ratelimit-input-tokens-remaining', b'19000'), (b'anthropic-ratelimit-input-tokens-reset', b'2025-05-26T04:55:40Z'), (b'anthropic-ratelimit-output-tokens-limit', b'4000'), (b'anthropic-ratelimit-output-tokens-remaining', b'4000'), (b'anthropic-ratelimit-output-tokens-reset', b'2025-05-26T04:55:36Z'), (b'anthropic-ratelimit-requests-limit', b'5'), (b'anthropic-ratelimit-requests-remaining', b'0'), (b'anthropic-ratelimit-requests-reset', b'2025-05-26T04:56:24Z'), (b'anthropic-ratelimit-tokens-limit', b'24000'), (b'anthropic-ratelimit-tokens-remaining', b'23000'), (b'anthropic-ratelimit-tokens-reset', b'2025-05-26T04:55:36Z'), (b'request-id', b'req_011CPVYe4BLmoZvJXWt8MtNV'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'anthropic-organization-id', b'22e5ed16-15d8-4ef0-a72f-fd41275bf557'), (b'via', b'1.1 google'), (b'cf-cache-status', b'DYNAMIC'), (b'X-Robots-Tag', b'none'), (b'Server', b'cloudflare'), (b'CF-RAY', b'945aae5df942d1f5-ICN'), (b'Content-Encoding', b'gzip')])]
[2025-05-26 13:55:36,551][DEBUG][receive_response_body.started request=<Request [b'POST']>]
[2025-05-26 13:55:36,551][DEBUG][receive_response_body.complete]
[2025-05-26 13:55:36,552][DEBUG][response_closed.started]
[2025-05-26 13:55:36,552][DEBUG][response_closed.complete]
[2025-05-26 13:55:36,552][DEBUG][HTTP Response: POST https://api.anthropic.com/v1/messages "200 OK" Headers({'date': 'Mon, 26 May 2025 04:55:36 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'anthropic-ratelimit-input-tokens-limit': '20000', 'anthropic-ratelimit-input-tokens-remaining': '19000', 'anthropic-ratelimit-input-tokens-reset': '2025-05-26T04:55:40Z', 'anthropic-ratelimit-output-tokens-limit': '4000', 'anthropic-ratelimit-output-tokens-remaining': '4000', 'anthropic-ratelimit-output-tokens-reset': '2025-05-26T04:55:36Z', 'anthropic-ratelimit-requests-limit': '5', 'anthropic-ratelimit-requests-remaining': '0', 'anthropic-ratelimit-requests-reset': '2025-05-26T04:56:24Z', 'anthropic-ratelimit-tokens-limit': '24000', 'anthropic-ratelimit-tokens-remaining': '23000', 'anthropic-ratelimit-tokens-reset': '2025-05-26T04:55:36Z', 'request-id': 'req_011CPVYe4BLmoZvJXWt8MtNV', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'anthropic-organization-id': '22e5ed16-15d8-4ef0-a72f-fd41275bf557', 'via': '1.1 google', 'cf-cache-status': 'DYNAMIC', 'x-robots-tag': 'none', 'server': 'cloudflare', 'cf-ray': '945aae5df942d1f5-ICN', 'content-encoding': 'gzip'})]
[2025-05-26 13:55:36,552][DEBUG][request_id: req_011CPVYe4BLmoZvJXWt8MtNV]
[2025-05-26 13:55:36,573][DEBUG][Request options: {'method': 'post', 'url': '/v1/messages', 'files': None, 'idempotency_key': 'stainless-python-retry-420de4aa-d682-4fc4-9d62-34dbed7855c1', 'json_data': {'max_tokens': 1024, 'messages': [{'role': 'user', 'content': 'Retrieved document: \n\n page_content=\'하나의 적용단위로 판단할 때 업종판단은 가장 많은 비율을 차지\n하는 현업업무종사자의 업태와 유사한 업종을 기준으로 판단함\n- 2 -\' metadata={\'source\': \'/Users/ranifarm/python-work/adaptive-rag/vectorstore/data/지방자치단체 산안법 적용 (산재예방정책과-3018 (2018.07.06. 시행).pdf\', \'file_path\': \'/Users/ranifarm/python-work/adaptive-rag/vectorstore/data/지방자치단체 산안법 적용 (산재예방정책과-3018 (2018.07.06. 시행).pdf\', \'page\': 1, \'total_pages\': 3, \'Author\': \'dw\', \'CreationDate\': "D:20241223160641+09\'00\'", \'Creator\': \'Hwp 2022 12.0.0.2416\', \'ModDate\': "D:20241223160641+09\'00\'", \'PDFVersion\': \'1.4\', \'Producer\': \'Hancom PDF 1.3.0.545\'} \n\n User question: content=\'인사와 대화 시작에 관한 일반적인 표현\' additional_kwargs={} response_metadata={\'id\': \'msg_014MxmkSScGAz17bz5ipdeET\', \'model\': \'claude-3-5-sonnet-20240620\', \'stop_reason\': \'end_turn\', \'stop_sequence\': None, \'usage\': {\'cache_creation_input_tokens\': 0, \'cache_read_input_tokens\': 0, \'input_tokens\': 136, \'output_tokens\': 25, \'server_tool_use\': None, \'service_tier\': \'standard\'}, \'model_name\': \'claude-3-5-sonnet-20240620\'} id=\'run--af4df5a3-dda4-49d6-8279-2d9f99270b02-0\' usage_metadata={\'input_tokens\': 136, \'output_tokens\': 25, \'total_tokens\': 161, \'input_token_details\': {\'cache_read\': 0, \'cache_creation\': 0}}'}], 'model': 'claude-3-5-sonnet-20240620', 'system': "채점자는 검색된 문서와 사용자 질문의 관련성을 평가하는 채점자입니다. \\n \n문서에 사용자 질문과 관련된 키워드 또는 의미론적 의미가 포함되어 있으면 관련성이 있는 것으로 채점합니다. \\n\n잘못된 검색을 걸러내는 것이 목표입니다. \\n\n문서가 질문으로 해결할 수 있는 내용인지 여부를 나타내는 이진 점수 'Y' 또는 'N'을 부여합니다.\n", 'temperature': 0.0, 'tool_choice': {'type': 'tool', 'name': 'GradeDocuments'}, 'tools': [{'name': 'GradeDocuments', 'input_schema': {'properties': {'pass_yn': {'description': "문서가 질문으로 해결 가능한 내용인지에 따라 'Y' 또는 'N' 로 답합니다.", 'enum': ['Y', 'N'], 'type': 'string'}}, 'required': ['pass_yn'], 'type': 'object'}, 'description': '검색된 문서가 질문으로 해결 가능한 내용인지에 대한 여부를 판단합니다.'}]}}]
[2025-05-26 13:55:36,574][DEBUG][Sending HTTP Request: POST https://api.anthropic.com/v1/messages]
[2025-05-26 13:55:36,574][DEBUG][connect_tcp.started host='api.anthropic.com' port=443 local_address=None timeout=None socket_options=[(65535, 8, True), (6, 257, 60), (6, 258, 5)]]
[2025-05-26 13:55:36,587][DEBUG][connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x3aef1a950>]
[2025-05-26 13:55:36,588][DEBUG][start_tls.started ssl_context=<ssl.SSLContext object at 0x3aef8df40> server_hostname='api.anthropic.com' timeout=None]
[2025-05-26 13:55:36,599][DEBUG][start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x306a4d990>]
[2025-05-26 13:55:36,599][DEBUG][send_request_headers.started request=<Request [b'POST']>]
[2025-05-26 13:55:36,599][DEBUG][send_request_headers.complete]
[2025-05-26 13:55:36,599][DEBUG][send_request_body.started request=<Request [b'POST']>]
[2025-05-26 13:55:36,599][DEBUG][send_request_body.complete]
[2025-05-26 13:55:36,599][DEBUG][receive_response_headers.started request=<Request [b'POST']>]
[2025-05-26 13:55:37,108][DEBUG][Sending compressed multipart request with context: trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=ed16e0ba-66d7-478f-a33d-43bfb475bb96; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=060d37c3-600a-4783-8202-2e3f14dd2f6d; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=060d37c3-600a-4783-8202-2e3f14dd2f6d; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=959af524-1133-4d24-b4e7-4a14edc48efc; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=5cbfcfd9-9d65-4504-ac66-cbb67184c9f7; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=9f3bb851-7080-4c4f-beec-bbb406b4f20d; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=9f3bb851-7080-4c4f-beec-bbb406b4f20d; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=775b06bc-77aa-4ab6-8718-c35261551226]
[2025-05-26 13:55:37,334][DEBUG][https://api.smith.langchain.com:443 "POST /runs/multipart HTTP/1.1" 202 34]
[2025-05-26 13:55:37,914][DEBUG][receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 26 May 2025 04:55:37 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'anthropic-ratelimit-input-tokens-limit', b'20000'), (b'anthropic-ratelimit-input-tokens-remaining', b'17000'), (b'anthropic-ratelimit-input-tokens-reset', b'2025-05-26T04:55:44Z'), (b'anthropic-ratelimit-output-tokens-limit', b'4000'), (b'anthropic-ratelimit-output-tokens-remaining', b'4000'), (b'anthropic-ratelimit-output-tokens-reset', b'2025-05-26T04:55:37Z'), (b'anthropic-ratelimit-requests-limit', b'5'), (b'anthropic-ratelimit-requests-remaining', b'0'), (b'anthropic-ratelimit-requests-reset', b'2025-05-26T04:56:36Z'), (b'anthropic-ratelimit-tokens-limit', b'24000'), (b'anthropic-ratelimit-tokens-remaining', b'21000'), (b'anthropic-ratelimit-tokens-reset', b'2025-05-26T04:55:37Z'), (b'request-id', b'req_011CPVYe9UqGS8YWVDoJULYt'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'anthropic-organization-id', b'22e5ed16-15d8-4ef0-a72f-fd41275bf557'), (b'via', b'1.1 google'), (b'cf-cache-status', b'DYNAMIC'), (b'X-Robots-Tag', b'none'), (b'Server', b'cloudflare'), (b'CF-RAY', b'945aae65bec1d1ed-ICN'), (b'Content-Encoding', b'gzip')])]
[2025-05-26 13:55:37,917][DEBUG][receive_response_body.started request=<Request [b'POST']>]
[2025-05-26 13:55:37,917][DEBUG][receive_response_body.complete]
[2025-05-26 13:55:37,917][DEBUG][response_closed.started]
[2025-05-26 13:55:37,918][DEBUG][response_closed.complete]
[2025-05-26 13:55:37,918][DEBUG][HTTP Response: POST https://api.anthropic.com/v1/messages "200 OK" Headers({'date': 'Mon, 26 May 2025 04:55:37 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'anthropic-ratelimit-input-tokens-limit': '20000', 'anthropic-ratelimit-input-tokens-remaining': '17000', 'anthropic-ratelimit-input-tokens-reset': '2025-05-26T04:55:44Z', 'anthropic-ratelimit-output-tokens-limit': '4000', 'anthropic-ratelimit-output-tokens-remaining': '4000', 'anthropic-ratelimit-output-tokens-reset': '2025-05-26T04:55:37Z', 'anthropic-ratelimit-requests-limit': '5', 'anthropic-ratelimit-requests-remaining': '0', 'anthropic-ratelimit-requests-reset': '2025-05-26T04:56:36Z', 'anthropic-ratelimit-tokens-limit': '24000', 'anthropic-ratelimit-tokens-remaining': '21000', 'anthropic-ratelimit-tokens-reset': '2025-05-26T04:55:37Z', 'request-id': 'req_011CPVYe9UqGS8YWVDoJULYt', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'anthropic-organization-id': '22e5ed16-15d8-4ef0-a72f-fd41275bf557', 'via': '1.1 google', 'cf-cache-status': 'DYNAMIC', 'x-robots-tag': 'none', 'server': 'cloudflare', 'cf-ray': '945aae65bec1d1ed-ICN', 'content-encoding': 'gzip'})]
[2025-05-26 13:55:37,918][DEBUG][request_id: req_011CPVYe9UqGS8YWVDoJULYt]
[2025-05-26 13:55:37,929][DEBUG][close.started]
[2025-05-26 13:55:37,930][DEBUG][close.complete]
[2025-05-26 13:55:37,948][DEBUG][Request options: {'method': 'post', 'url': '/v1/messages', 'files': None, 'idempotency_key': 'stainless-python-retry-dd4cfe4e-8cb8-495b-9bd5-50fa9db3701a', 'json_data': {'max_tokens': 1024, 'messages': [{'role': 'user', 'content': 'Retrieved document: \n\n page_content=\'있으면 원칙적으로 분리하지 않고 하나의 사업장으로 보며, 장소적으로 분산\n되어 있는 경우에는 원칙적으로 별개의 사업장으로 보아야 할 것임 다만, 동일한\n장소에 있더라도 현저하게 근로의 양태가 다른 부분이 있고 그러한 부문\n이 주된 부문과 비교하여 노무관리 등이 명확하게 구분되고, 주된 부문과\n분리하여 취급함으로써 산업안전보건법이 보다 적절하게 운용될 수 있는\n경우에는 그러한 부문을 독립된 사업장으로 보아야 하며, 장소적으로 분산\n되어 있더라도 출장소, 사업소, 지점 등이 업무처리 능력 등을 감안할 때\' metadata={\'source\': \'/Users/ranifarm/python-work/adaptive-rag/vectorstore/data/지방자치단체 산안법 적용 (산재예방정책과-3018 (2018.07.06. 시행).pdf\', \'file_path\': \'/Users/ranifarm/python-work/adaptive-rag/vectorstore/data/지방자치단체 산안법 적용 (산재예방정책과-3018 (2018.07.06. 시행).pdf\', \'page\': 0, \'total_pages\': 3, \'Author\': \'dw\', \'CreationDate\': "D:20241223160641+09\'00\'", \'Creator\': \'Hwp 2022 12.0.0.2416\', \'ModDate\': "D:20241223160641+09\'00\'", \'PDFVersion\': \'1.4\', \'Producer\': \'Hancom PDF 1.3.0.545\'} \n\n User question: content=\'인사와 대화 시작에 관한 일반적인 표현\' additional_kwargs={} response_metadata={\'id\': \'msg_014MxmkSScGAz17bz5ipdeET\', \'model\': \'claude-3-5-sonnet-20240620\', \'stop_reason\': \'end_turn\', \'stop_sequence\': None, \'usage\': {\'cache_creation_input_tokens\': 0, \'cache_read_input_tokens\': 0, \'input_tokens\': 136, \'output_tokens\': 25, \'server_tool_use\': None, \'service_tier\': \'standard\'}, \'model_name\': \'claude-3-5-sonnet-20240620\'} id=\'run--af4df5a3-dda4-49d6-8279-2d9f99270b02-0\' usage_metadata={\'input_tokens\': 136, \'output_tokens\': 25, \'total_tokens\': 161, \'input_token_details\': {\'cache_read\': 0, \'cache_creation\': 0}}'}], 'model': 'claude-3-5-sonnet-20240620', 'system': "채점자는 검색된 문서와 사용자 질문의 관련성을 평가하는 채점자입니다. \\n \n문서에 사용자 질문과 관련된 키워드 또는 의미론적 의미가 포함되어 있으면 관련성이 있는 것으로 채점합니다. \\n\n잘못된 검색을 걸러내는 것이 목표입니다. \\n\n문서가 질문으로 해결할 수 있는 내용인지 여부를 나타내는 이진 점수 'Y' 또는 'N'을 부여합니다.\n", 'temperature': 0.0, 'tool_choice': {'type': 'tool', 'name': 'GradeDocuments'}, 'tools': [{'name': 'GradeDocuments', 'input_schema': {'properties': {'pass_yn': {'description': "문서가 질문으로 해결 가능한 내용인지에 따라 'Y' 또는 'N' 로 답합니다.", 'enum': ['Y', 'N'], 'type': 'string'}}, 'required': ['pass_yn'], 'type': 'object'}, 'description': '검색된 문서가 질문으로 해결 가능한 내용인지에 대한 여부를 판단합니다.'}]}}]
[2025-05-26 13:55:37,949][DEBUG][Sending HTTP Request: POST https://api.anthropic.com/v1/messages]
[2025-05-26 13:55:37,949][DEBUG][connect_tcp.started host='api.anthropic.com' port=443 local_address=None timeout=None socket_options=[(65535, 8, True), (6, 257, 60), (6, 258, 5)]]
[2025-05-26 13:55:37,961][DEBUG][connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x3aef1b090>]
[2025-05-26 13:55:37,962][DEBUG][start_tls.started ssl_context=<ssl.SSLContext object at 0x3aef8dd90> server_hostname='api.anthropic.com' timeout=None]
[2025-05-26 13:55:37,974][DEBUG][start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x3aef1b210>]
[2025-05-26 13:55:37,974][DEBUG][send_request_headers.started request=<Request [b'POST']>]
[2025-05-26 13:55:37,975][DEBUG][send_request_headers.complete]
[2025-05-26 13:55:37,975][DEBUG][send_request_body.started request=<Request [b'POST']>]
[2025-05-26 13:55:37,975][DEBUG][send_request_body.complete]
[2025-05-26 13:55:37,975][DEBUG][receive_response_headers.started request=<Request [b'POST']>]
[2025-05-26 13:55:38,238][DEBUG][receive_response_headers.complete return_value=(b'HTTP/1.1', 429, b'Too Many Requests', [(b'Date', b'Mon, 26 May 2025 04:55:38 GMT'), (b'Content-Type', b'application/json'), (b'Content-Length', b'520'), (b'Connection', b'keep-alive'), (b'x-should-retry', b'true'), (b'anthropic-ratelimit-input-tokens-limit', b'20000'), (b'anthropic-ratelimit-input-tokens-remaining', b'18000'), (b'anthropic-ratelimit-input-tokens-reset', b'2025-05-26T04:55:44Z'), (b'anthropic-ratelimit-output-tokens-limit', b'4000'), (b'anthropic-ratelimit-output-tokens-remaining', b'4000'), (b'anthropic-ratelimit-output-tokens-reset', b'2025-05-26T04:55:38Z'), (b'anthropic-ratelimit-requests-limit', b'5'), (b'anthropic-ratelimit-requests-remaining', b'0'), (b'anthropic-ratelimit-requests-reset', b'2025-05-26T04:56:36Z'), (b'retry-after', b'11'), (b'anthropic-ratelimit-tokens-limit', b'24000'), (b'anthropic-ratelimit-tokens-remaining', b'22000'), (b'anthropic-ratelimit-tokens-reset', b'2025-05-26T04:55:38Z'), (b'request-id', b'req_011CPVYeFPXhcEQ8A4noCHow'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'anthropic-organization-id', b'22e5ed16-15d8-4ef0-a72f-fd41275bf557'), (b'via', b'1.1 google'), (b'cf-cache-status', b'DYNAMIC'), (b'X-Robots-Tag', b'none'), (b'Server', b'cloudflare'), (b'CF-RAY', b'945aae6e5e5e3284-ICN')])]
[2025-05-26 13:55:38,240][DEBUG][receive_response_body.started request=<Request [b'POST']>]
[2025-05-26 13:55:38,241][DEBUG][receive_response_body.complete]
[2025-05-26 13:55:38,241][DEBUG][response_closed.started]
[2025-05-26 13:55:38,241][DEBUG][response_closed.complete]
[2025-05-26 13:55:38,241][DEBUG][HTTP Response: POST https://api.anthropic.com/v1/messages "429 Too Many Requests" Headers({'date': 'Mon, 26 May 2025 04:55:38 GMT', 'content-type': 'application/json', 'content-length': '520', 'connection': 'keep-alive', 'x-should-retry': 'true', 'anthropic-ratelimit-input-tokens-limit': '20000', 'anthropic-ratelimit-input-tokens-remaining': '18000', 'anthropic-ratelimit-input-tokens-reset': '2025-05-26T04:55:44Z', 'anthropic-ratelimit-output-tokens-limit': '4000', 'anthropic-ratelimit-output-tokens-remaining': '4000', 'anthropic-ratelimit-output-tokens-reset': '2025-05-26T04:55:38Z', 'anthropic-ratelimit-requests-limit': '5', 'anthropic-ratelimit-requests-remaining': '0', 'anthropic-ratelimit-requests-reset': '2025-05-26T04:56:36Z', 'retry-after': '11', 'anthropic-ratelimit-tokens-limit': '24000', 'anthropic-ratelimit-tokens-remaining': '22000', 'anthropic-ratelimit-tokens-reset': '2025-05-26T04:55:38Z', 'request-id': 'req_011CPVYeFPXhcEQ8A4noCHow', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'anthropic-organization-id': '22e5ed16-15d8-4ef0-a72f-fd41275bf557', 'via': '1.1 google', 'cf-cache-status': 'DYNAMIC', 'x-robots-tag': 'none', 'server': 'cloudflare', 'cf-ray': '945aae6e5e5e3284-ICN'})]
[2025-05-26 13:55:38,242][DEBUG][request_id: req_011CPVYeFPXhcEQ8A4noCHow]
[2025-05-26 13:55:38,242][DEBUG][Encountered httpx.HTTPStatusError]
Traceback (most recent call last):
  File "/Users/ranifarm/.conda/envs/adaptive-rag/lib/python3.11/site-packages/anthropic/_base_client.py", line 1065, in request
    response.raise_for_status()
  File "/Users/ranifarm/.conda/envs/adaptive-rag/lib/python3.11/site-packages/httpx/_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '429 Too Many Requests' for url 'https://api.anthropic.com/v1/messages'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429
[2025-05-26 13:55:38,252][DEBUG][Retrying as header `x-should-retry` is set to `true`]
[2025-05-26 13:55:38,252][DEBUG][2 retries left]
[2025-05-26 13:55:38,475][DEBUG][Sending compressed multipart request with context: trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=775b06bc-77aa-4ab6-8718-c35261551226; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=d0ddd994-0289-4f03-925c-a80f02dd4629; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=d0ddd994-0289-4f03-925c-a80f02dd4629; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=5cbfcfd9-9d65-4504-ac66-cbb67184c9f7; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=b8e4ca9d-96d8-4733-8000-50743a9e178e; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=8984ccc4-cfa5-448f-ab74-9a0bca771abc; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=8984ccc4-cfa5-448f-ab74-9a0bca771abc; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=25e7ce12-be59-4fa1-b6f2-3e452f2076f4]
[2025-05-26 13:55:38,709][DEBUG][https://api.smith.langchain.com:443 "POST /runs/multipart HTTP/1.1" 202 34]
[2025-05-26 13:55:49,258][DEBUG][Request options: {'method': 'post', 'url': '/v1/messages', 'files': None, 'idempotency_key': 'stainless-python-retry-dd4cfe4e-8cb8-495b-9bd5-50fa9db3701a', 'json_data': {'max_tokens': 1024, 'messages': [{'role': 'user', 'content': 'Retrieved document: \n\n page_content=\'있으면 원칙적으로 분리하지 않고 하나의 사업장으로 보며, 장소적으로 분산\n되어 있는 경우에는 원칙적으로 별개의 사업장으로 보아야 할 것임 다만, 동일한\n장소에 있더라도 현저하게 근로의 양태가 다른 부분이 있고 그러한 부문\n이 주된 부문과 비교하여 노무관리 등이 명확하게 구분되고, 주된 부문과\n분리하여 취급함으로써 산업안전보건법이 보다 적절하게 운용될 수 있는\n경우에는 그러한 부문을 독립된 사업장으로 보아야 하며, 장소적으로 분산\n되어 있더라도 출장소, 사업소, 지점 등이 업무처리 능력 등을 감안할 때\' metadata={\'source\': \'/Users/ranifarm/python-work/adaptive-rag/vectorstore/data/지방자치단체 산안법 적용 (산재예방정책과-3018 (2018.07.06. 시행).pdf\', \'file_path\': \'/Users/ranifarm/python-work/adaptive-rag/vectorstore/data/지방자치단체 산안법 적용 (산재예방정책과-3018 (2018.07.06. 시행).pdf\', \'page\': 0, \'total_pages\': 3, \'Author\': \'dw\', \'CreationDate\': "D:20241223160641+09\'00\'", \'Creator\': \'Hwp 2022 12.0.0.2416\', \'ModDate\': "D:20241223160641+09\'00\'", \'PDFVersion\': \'1.4\', \'Producer\': \'Hancom PDF 1.3.0.545\'} \n\n User question: content=\'인사와 대화 시작에 관한 일반적인 표현\' additional_kwargs={} response_metadata={\'id\': \'msg_014MxmkSScGAz17bz5ipdeET\', \'model\': \'claude-3-5-sonnet-20240620\', \'stop_reason\': \'end_turn\', \'stop_sequence\': None, \'usage\': {\'cache_creation_input_tokens\': 0, \'cache_read_input_tokens\': 0, \'input_tokens\': 136, \'output_tokens\': 25, \'server_tool_use\': None, \'service_tier\': \'standard\'}, \'model_name\': \'claude-3-5-sonnet-20240620\'} id=\'run--af4df5a3-dda4-49d6-8279-2d9f99270b02-0\' usage_metadata={\'input_tokens\': 136, \'output_tokens\': 25, \'total_tokens\': 161, \'input_token_details\': {\'cache_read\': 0, \'cache_creation\': 0}}'}], 'model': 'claude-3-5-sonnet-20240620', 'system': "채점자는 검색된 문서와 사용자 질문의 관련성을 평가하는 채점자입니다. \\n \n문서에 사용자 질문과 관련된 키워드 또는 의미론적 의미가 포함되어 있으면 관련성이 있는 것으로 채점합니다. \\n\n잘못된 검색을 걸러내는 것이 목표입니다. \\n\n문서가 질문으로 해결할 수 있는 내용인지 여부를 나타내는 이진 점수 'Y' 또는 'N'을 부여합니다.\n", 'temperature': 0.0, 'tool_choice': {'type': 'tool', 'name': 'GradeDocuments'}, 'tools': [{'name': 'GradeDocuments', 'input_schema': {'properties': {'pass_yn': {'description': "문서가 질문으로 해결 가능한 내용인지에 따라 'Y' 또는 'N' 로 답합니다.", 'enum': ['Y', 'N'], 'type': 'string'}}, 'required': ['pass_yn'], 'type': 'object'}, 'description': '검색된 문서가 질문으로 해결 가능한 내용인지에 대한 여부를 판단합니다.'}]}}]
[2025-05-26 13:55:49,260][DEBUG][Sending HTTP Request: POST https://api.anthropic.com/v1/messages]
[2025-05-26 13:55:49,261][DEBUG][close.started]
[2025-05-26 13:55:49,262][DEBUG][close.complete]
[2025-05-26 13:55:49,262][DEBUG][connect_tcp.started host='api.anthropic.com' port=443 local_address=None timeout=None socket_options=[(65535, 8, True), (6, 257, 60), (6, 258, 5)]]
[2025-05-26 13:55:49,305][DEBUG][connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x306a88ad0>]
[2025-05-26 13:55:49,305][DEBUG][start_tls.started ssl_context=<ssl.SSLContext object at 0x3aef8dd90> server_hostname='api.anthropic.com' timeout=None]
[2025-05-26 13:55:49,328][DEBUG][start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x306a88d50>]
[2025-05-26 13:55:49,328][DEBUG][send_request_headers.started request=<Request [b'POST']>]
[2025-05-26 13:55:49,329][DEBUG][send_request_headers.complete]
[2025-05-26 13:55:49,329][DEBUG][send_request_body.started request=<Request [b'POST']>]
[2025-05-26 13:55:49,329][DEBUG][send_request_body.complete]
[2025-05-26 13:55:49,329][DEBUG][receive_response_headers.started request=<Request [b'POST']>]
[2025-05-26 13:55:50,560][DEBUG][receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 26 May 2025 04:55:50 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'anthropic-ratelimit-input-tokens-limit', b'20000'), (b'anthropic-ratelimit-input-tokens-remaining', b'19000'), (b'anthropic-ratelimit-input-tokens-reset', b'2025-05-26T04:55:54Z'), (b'anthropic-ratelimit-output-tokens-limit', b'4000'), (b'anthropic-ratelimit-output-tokens-remaining', b'4000'), (b'anthropic-ratelimit-output-tokens-reset', b'2025-05-26T04:55:50Z'), (b'anthropic-ratelimit-requests-limit', b'5'), (b'anthropic-ratelimit-requests-remaining', b'0'), (b'anthropic-ratelimit-requests-reset', b'2025-05-26T04:56:48Z'), (b'anthropic-ratelimit-tokens-limit', b'24000'), (b'anthropic-ratelimit-tokens-remaining', b'23000'), (b'anthropic-ratelimit-tokens-reset', b'2025-05-26T04:55:50Z'), (b'request-id', b'req_011CPVYf5vYHtqGZLo3qw2SV'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'anthropic-organization-id', b'22e5ed16-15d8-4ef0-a72f-fd41275bf557'), (b'via', b'1.1 google'), (b'cf-cache-status', b'DYNAMIC'), (b'X-Robots-Tag', b'none'), (b'Server', b'cloudflare'), (b'CF-RAY', b'945aaeb54974aa78-ICN'), (b'Content-Encoding', b'gzip')])]
[2025-05-26 13:55:50,560][DEBUG][receive_response_body.started request=<Request [b'POST']>]
[2025-05-26 13:55:50,561][DEBUG][receive_response_body.complete]
[2025-05-26 13:55:50,561][DEBUG][response_closed.started]
[2025-05-26 13:55:50,561][DEBUG][response_closed.complete]
[2025-05-26 13:55:50,561][DEBUG][HTTP Response: POST https://api.anthropic.com/v1/messages "200 OK" Headers({'date': 'Mon, 26 May 2025 04:55:50 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'anthropic-ratelimit-input-tokens-limit': '20000', 'anthropic-ratelimit-input-tokens-remaining': '19000', 'anthropic-ratelimit-input-tokens-reset': '2025-05-26T04:55:54Z', 'anthropic-ratelimit-output-tokens-limit': '4000', 'anthropic-ratelimit-output-tokens-remaining': '4000', 'anthropic-ratelimit-output-tokens-reset': '2025-05-26T04:55:50Z', 'anthropic-ratelimit-requests-limit': '5', 'anthropic-ratelimit-requests-remaining': '0', 'anthropic-ratelimit-requests-reset': '2025-05-26T04:56:48Z', 'anthropic-ratelimit-tokens-limit': '24000', 'anthropic-ratelimit-tokens-remaining': '23000', 'anthropic-ratelimit-tokens-reset': '2025-05-26T04:55:50Z', 'request-id': 'req_011CPVYf5vYHtqGZLo3qw2SV', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'anthropic-organization-id': '22e5ed16-15d8-4ef0-a72f-fd41275bf557', 'via': '1.1 google', 'cf-cache-status': 'DYNAMIC', 'x-robots-tag': 'none', 'server': 'cloudflare', 'cf-ray': '945aaeb54974aa78-ICN', 'content-encoding': 'gzip'})]
[2025-05-26 13:55:50,561][DEBUG][request_id: req_011CPVYf5vYHtqGZLo3qw2SV]
[2025-05-26 13:55:50,566][DEBUG][close.started]
[2025-05-26 13:55:50,567][DEBUG][close.complete]
[2025-05-26 13:55:50,579][DEBUG][Request options: {'method': 'post', 'url': '/v1/messages', 'files': None, 'idempotency_key': 'stainless-python-retry-0d7b5aeb-e295-469a-b016-e53326dff735', 'json_data': {'max_tokens': 1024, 'messages': [{'role': 'user', 'content': 'Retrieved document: \n\n page_content=\'- 지방자치단체가 행하는 일반 행정사무는 공공행정에 해당하므로\n해당 업무를 하는 소속 공무원 및 근로자에게는 ｢산업안전보\n건법｣의 일부 규정이 시행령 별표1에 의해 적용제외 됨\n- 1 -\' metadata={\'source\': \'/Users/ranifarm/python-work/adaptive-rag/vectorstore/data/지방자치단체 산안법 적용 (산재예방정책과-3018 (2018.07.06. 시행).pdf\', \'file_path\': \'/Users/ranifarm/python-work/adaptive-rag/vectorstore/data/지방자치단체 산안법 적용 (산재예방정책과-3018 (2018.07.06. 시행).pdf\', \'page\': 0, \'total_pages\': 3, \'Author\': \'dw\', \'CreationDate\': "D:20241223160641+09\'00\'", \'Creator\': \'Hwp 2022 12.0.0.2416\', \'ModDate\': "D:20241223160641+09\'00\'", \'PDFVersion\': \'1.4\', \'Producer\': \'Hancom PDF 1.3.0.545\'} \n\n User question: content=\'인사와 대화 시작에 관한 일반적인 표현\' additional_kwargs={} response_metadata={\'id\': \'msg_014MxmkSScGAz17bz5ipdeET\', \'model\': \'claude-3-5-sonnet-20240620\', \'stop_reason\': \'end_turn\', \'stop_sequence\': None, \'usage\': {\'cache_creation_input_tokens\': 0, \'cache_read_input_tokens\': 0, \'input_tokens\': 136, \'output_tokens\': 25, \'server_tool_use\': None, \'service_tier\': \'standard\'}, \'model_name\': \'claude-3-5-sonnet-20240620\'} id=\'run--af4df5a3-dda4-49d6-8279-2d9f99270b02-0\' usage_metadata={\'input_tokens\': 136, \'output_tokens\': 25, \'total_tokens\': 161, \'input_token_details\': {\'cache_read\': 0, \'cache_creation\': 0}}'}], 'model': 'claude-3-5-sonnet-20240620', 'system': "채점자는 검색된 문서와 사용자 질문의 관련성을 평가하는 채점자입니다. \\n \n문서에 사용자 질문과 관련된 키워드 또는 의미론적 의미가 포함되어 있으면 관련성이 있는 것으로 채점합니다. \\n\n잘못된 검색을 걸러내는 것이 목표입니다. \\n\n문서가 질문으로 해결할 수 있는 내용인지 여부를 나타내는 이진 점수 'Y' 또는 'N'을 부여합니다.\n", 'temperature': 0.0, 'tool_choice': {'type': 'tool', 'name': 'GradeDocuments'}, 'tools': [{'name': 'GradeDocuments', 'input_schema': {'properties': {'pass_yn': {'description': "문서가 질문으로 해결 가능한 내용인지에 따라 'Y' 또는 'N' 로 답합니다.", 'enum': ['Y', 'N'], 'type': 'string'}}, 'required': ['pass_yn'], 'type': 'object'}, 'description': '검색된 문서가 질문으로 해결 가능한 내용인지에 대한 여부를 판단합니다.'}]}}]
[2025-05-26 13:55:50,579][DEBUG][Sending HTTP Request: POST https://api.anthropic.com/v1/messages]
[2025-05-26 13:55:50,580][DEBUG][connect_tcp.started host='api.anthropic.com' port=443 local_address=None timeout=None socket_options=[(65535, 8, True), (6, 257, 60), (6, 258, 5)]]
[2025-05-26 13:55:50,589][DEBUG][connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x306e56550>]
[2025-05-26 13:55:50,589][DEBUG][start_tls.started ssl_context=<ssl.SSLContext object at 0x3aef8e210> server_hostname='api.anthropic.com' timeout=None]
[2025-05-26 13:55:50,621][DEBUG][start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x306e55c10>]
[2025-05-26 13:55:50,621][DEBUG][send_request_headers.started request=<Request [b'POST']>]
[2025-05-26 13:55:50,625][DEBUG][send_request_headers.complete]
[2025-05-26 13:55:50,626][DEBUG][send_request_body.started request=<Request [b'POST']>]
[2025-05-26 13:55:50,626][DEBUG][send_request_body.complete]
[2025-05-26 13:55:50,626][DEBUG][receive_response_headers.started request=<Request [b'POST']>]
[2025-05-26 13:55:50,868][DEBUG][receive_response_headers.complete return_value=(b'HTTP/1.1', 429, b'Too Many Requests', [(b'Date', b'Mon, 26 May 2025 04:55:50 GMT'), (b'Content-Type', b'application/json'), (b'Content-Length', b'520'), (b'Connection', b'keep-alive'), (b'x-should-retry', b'true'), (b'anthropic-ratelimit-input-tokens-limit', b'20000'), (b'anthropic-ratelimit-input-tokens-remaining', b'19000'), (b'anthropic-ratelimit-input-tokens-reset', b'2025-05-26T04:55:54Z'), (b'anthropic-ratelimit-output-tokens-limit', b'4000'), (b'anthropic-ratelimit-output-tokens-remaining', b'4000'), (b'anthropic-ratelimit-output-tokens-reset', b'2025-05-26T04:55:50Z'), (b'anthropic-ratelimit-requests-limit', b'5'), (b'anthropic-ratelimit-requests-remaining', b'0'), (b'anthropic-ratelimit-requests-reset', b'2025-05-26T04:56:48Z'), (b'retry-after', b'10'), (b'anthropic-ratelimit-tokens-limit', b'24000'), (b'anthropic-ratelimit-tokens-remaining', b'23000'), (b'anthropic-ratelimit-tokens-reset', b'2025-05-26T04:55:50Z'), (b'request-id', b'req_011CPVYfBTftj2CELtWh7afb'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'anthropic-organization-id', b'22e5ed16-15d8-4ef0-a72f-fd41275bf557'), (b'via', b'1.1 google'), (b'cf-cache-status', b'DYNAMIC'), (b'X-Robots-Tag', b'none'), (b'Server', b'cloudflare'), (b'CF-RAY', b'945aaebd696903cc-ICN')])]
[2025-05-26 13:55:50,868][DEBUG][receive_response_body.started request=<Request [b'POST']>]
[2025-05-26 13:55:50,870][DEBUG][receive_response_body.complete]
[2025-05-26 13:55:50,870][DEBUG][response_closed.started]
[2025-05-26 13:55:50,871][DEBUG][response_closed.complete]
[2025-05-26 13:55:50,871][DEBUG][HTTP Response: POST https://api.anthropic.com/v1/messages "429 Too Many Requests" Headers({'date': 'Mon, 26 May 2025 04:55:50 GMT', 'content-type': 'application/json', 'content-length': '520', 'connection': 'keep-alive', 'x-should-retry': 'true', 'anthropic-ratelimit-input-tokens-limit': '20000', 'anthropic-ratelimit-input-tokens-remaining': '19000', 'anthropic-ratelimit-input-tokens-reset': '2025-05-26T04:55:54Z', 'anthropic-ratelimit-output-tokens-limit': '4000', 'anthropic-ratelimit-output-tokens-remaining': '4000', 'anthropic-ratelimit-output-tokens-reset': '2025-05-26T04:55:50Z', 'anthropic-ratelimit-requests-limit': '5', 'anthropic-ratelimit-requests-remaining': '0', 'anthropic-ratelimit-requests-reset': '2025-05-26T04:56:48Z', 'retry-after': '10', 'anthropic-ratelimit-tokens-limit': '24000', 'anthropic-ratelimit-tokens-remaining': '23000', 'anthropic-ratelimit-tokens-reset': '2025-05-26T04:55:50Z', 'request-id': 'req_011CPVYfBTftj2CELtWh7afb', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'anthropic-organization-id': '22e5ed16-15d8-4ef0-a72f-fd41275bf557', 'via': '1.1 google', 'cf-cache-status': 'DYNAMIC', 'x-robots-tag': 'none', 'server': 'cloudflare', 'cf-ray': '945aaebd696903cc-ICN'})]
[2025-05-26 13:55:50,871][DEBUG][request_id: req_011CPVYfBTftj2CELtWh7afb]
[2025-05-26 13:55:50,871][DEBUG][Encountered httpx.HTTPStatusError]
Traceback (most recent call last):
  File "/Users/ranifarm/.conda/envs/adaptive-rag/lib/python3.11/site-packages/anthropic/_base_client.py", line 1065, in request
    response.raise_for_status()
  File "/Users/ranifarm/.conda/envs/adaptive-rag/lib/python3.11/site-packages/httpx/_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '429 Too Many Requests' for url 'https://api.anthropic.com/v1/messages'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429
[2025-05-26 13:55:50,872][DEBUG][Retrying as header `x-should-retry` is set to `true`]
[2025-05-26 13:55:50,872][DEBUG][2 retries left]
[2025-05-26 13:55:51,110][DEBUG][Sending compressed multipart request with context: trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=25e7ce12-be59-4fa1-b6f2-3e452f2076f4; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=0a532fdb-c259-4bdf-a244-fe5e371493a6; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=0a532fdb-c259-4bdf-a244-fe5e371493a6; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=b8e4ca9d-96d8-4733-8000-50743a9e178e; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=92ff6fe6-8b43-4969-bd08-412861c51582; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=4be76a3a-b124-43b8-8793-314f5a96e40b; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=4be76a3a-b124-43b8-8793-314f5a96e40b; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=46b02680-1f54-487a-9b9d-5ca1697daed0]
[2025-05-26 13:55:51,319][DEBUG][https://api.smith.langchain.com:443 "POST /runs/multipart HTTP/1.1" 202 34]
[2025-05-26 13:56:00,875][DEBUG][Request options: {'method': 'post', 'url': '/v1/messages', 'files': None, 'idempotency_key': 'stainless-python-retry-0d7b5aeb-e295-469a-b016-e53326dff735', 'json_data': {'max_tokens': 1024, 'messages': [{'role': 'user', 'content': 'Retrieved document: \n\n page_content=\'- 지방자치단체가 행하는 일반 행정사무는 공공행정에 해당하므로\n해당 업무를 하는 소속 공무원 및 근로자에게는 ｢산업안전보\n건법｣의 일부 규정이 시행령 별표1에 의해 적용제외 됨\n- 1 -\' metadata={\'source\': \'/Users/ranifarm/python-work/adaptive-rag/vectorstore/data/지방자치단체 산안법 적용 (산재예방정책과-3018 (2018.07.06. 시행).pdf\', \'file_path\': \'/Users/ranifarm/python-work/adaptive-rag/vectorstore/data/지방자치단체 산안법 적용 (산재예방정책과-3018 (2018.07.06. 시행).pdf\', \'page\': 0, \'total_pages\': 3, \'Author\': \'dw\', \'CreationDate\': "D:20241223160641+09\'00\'", \'Creator\': \'Hwp 2022 12.0.0.2416\', \'ModDate\': "D:20241223160641+09\'00\'", \'PDFVersion\': \'1.4\', \'Producer\': \'Hancom PDF 1.3.0.545\'} \n\n User question: content=\'인사와 대화 시작에 관한 일반적인 표현\' additional_kwargs={} response_metadata={\'id\': \'msg_014MxmkSScGAz17bz5ipdeET\', \'model\': \'claude-3-5-sonnet-20240620\', \'stop_reason\': \'end_turn\', \'stop_sequence\': None, \'usage\': {\'cache_creation_input_tokens\': 0, \'cache_read_input_tokens\': 0, \'input_tokens\': 136, \'output_tokens\': 25, \'server_tool_use\': None, \'service_tier\': \'standard\'}, \'model_name\': \'claude-3-5-sonnet-20240620\'} id=\'run--af4df5a3-dda4-49d6-8279-2d9f99270b02-0\' usage_metadata={\'input_tokens\': 136, \'output_tokens\': 25, \'total_tokens\': 161, \'input_token_details\': {\'cache_read\': 0, \'cache_creation\': 0}}'}], 'model': 'claude-3-5-sonnet-20240620', 'system': "채점자는 검색된 문서와 사용자 질문의 관련성을 평가하는 채점자입니다. \\n \n문서에 사용자 질문과 관련된 키워드 또는 의미론적 의미가 포함되어 있으면 관련성이 있는 것으로 채점합니다. \\n\n잘못된 검색을 걸러내는 것이 목표입니다. \\n\n문서가 질문으로 해결할 수 있는 내용인지 여부를 나타내는 이진 점수 'Y' 또는 'N'을 부여합니다.\n", 'temperature': 0.0, 'tool_choice': {'type': 'tool', 'name': 'GradeDocuments'}, 'tools': [{'name': 'GradeDocuments', 'input_schema': {'properties': {'pass_yn': {'description': "문서가 질문으로 해결 가능한 내용인지에 따라 'Y' 또는 'N' 로 답합니다.", 'enum': ['Y', 'N'], 'type': 'string'}}, 'required': ['pass_yn'], 'type': 'object'}, 'description': '검색된 문서가 질문으로 해결 가능한 내용인지에 대한 여부를 판단합니다.'}]}}]
[2025-05-26 13:56:00,876][DEBUG][Sending HTTP Request: POST https://api.anthropic.com/v1/messages]
[2025-05-26 13:56:00,876][DEBUG][close.started]
[2025-05-26 13:56:00,876][DEBUG][close.complete]
[2025-05-26 13:56:00,876][DEBUG][connect_tcp.started host='api.anthropic.com' port=443 local_address=None timeout=None socket_options=[(65535, 8, True), (6, 257, 60), (6, 258, 5)]]
[2025-05-26 13:56:00,886][DEBUG][connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x3aed6df50>]
[2025-05-26 13:56:00,886][DEBUG][start_tls.started ssl_context=<ssl.SSLContext object at 0x3aef8e210> server_hostname='api.anthropic.com' timeout=None]
[2025-05-26 13:56:00,901][DEBUG][start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x3aed6d750>]
[2025-05-26 13:56:00,901][DEBUG][send_request_headers.started request=<Request [b'POST']>]
[2025-05-26 13:56:00,901][DEBUG][send_request_headers.complete]
[2025-05-26 13:56:00,901][DEBUG][send_request_body.started request=<Request [b'POST']>]
[2025-05-26 13:56:00,901][DEBUG][send_request_body.complete]
[2025-05-26 13:56:00,901][DEBUG][receive_response_headers.started request=<Request [b'POST']>]
[2025-05-26 13:56:02,596][DEBUG][receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 26 May 2025 04:56:02 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'anthropic-ratelimit-input-tokens-limit', b'20000'), (b'anthropic-ratelimit-input-tokens-remaining', b'19000'), (b'anthropic-ratelimit-input-tokens-reset', b'2025-05-26T04:56:05Z'), (b'anthropic-ratelimit-output-tokens-limit', b'4000'), (b'anthropic-ratelimit-output-tokens-remaining', b'4000'), (b'anthropic-ratelimit-output-tokens-reset', b'2025-05-26T04:56:02Z'), (b'anthropic-ratelimit-requests-limit', b'5'), (b'anthropic-ratelimit-requests-remaining', b'0'), (b'anthropic-ratelimit-requests-reset', b'2025-05-26T04:57:00Z'), (b'anthropic-ratelimit-tokens-limit', b'24000'), (b'anthropic-ratelimit-tokens-remaining', b'23000'), (b'anthropic-ratelimit-tokens-reset', b'2025-05-26T04:56:02Z'), (b'request-id', b'req_011CPVYfwRqtvUcpcqZCZ5pr'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'anthropic-organization-id', b'22e5ed16-15d8-4ef0-a72f-fd41275bf557'), (b'via', b'1.1 google'), (b'cf-cache-status', b'DYNAMIC'), (b'X-Robots-Tag', b'none'), (b'Server', b'cloudflare'), (b'CF-RAY', b'945aaefda9b13275-ICN'), (b'Content-Encoding', b'gzip')])]
[2025-05-26 13:56:02,597][DEBUG][receive_response_body.started request=<Request [b'POST']>]
[2025-05-26 13:56:02,597][DEBUG][receive_response_body.complete]
[2025-05-26 13:56:02,597][DEBUG][response_closed.started]
[2025-05-26 13:56:02,597][DEBUG][response_closed.complete]
[2025-05-26 13:56:02,597][DEBUG][HTTP Response: POST https://api.anthropic.com/v1/messages "200 OK" Headers({'date': 'Mon, 26 May 2025 04:56:02 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'anthropic-ratelimit-input-tokens-limit': '20000', 'anthropic-ratelimit-input-tokens-remaining': '19000', 'anthropic-ratelimit-input-tokens-reset': '2025-05-26T04:56:05Z', 'anthropic-ratelimit-output-tokens-limit': '4000', 'anthropic-ratelimit-output-tokens-remaining': '4000', 'anthropic-ratelimit-output-tokens-reset': '2025-05-26T04:56:02Z', 'anthropic-ratelimit-requests-limit': '5', 'anthropic-ratelimit-requests-remaining': '0', 'anthropic-ratelimit-requests-reset': '2025-05-26T04:57:00Z', 'anthropic-ratelimit-tokens-limit': '24000', 'anthropic-ratelimit-tokens-remaining': '23000', 'anthropic-ratelimit-tokens-reset': '2025-05-26T04:56:02Z', 'request-id': 'req_011CPVYfwRqtvUcpcqZCZ5pr', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'anthropic-organization-id': '22e5ed16-15d8-4ef0-a72f-fd41275bf557', 'via': '1.1 google', 'cf-cache-status': 'DYNAMIC', 'x-robots-tag': 'none', 'server': 'cloudflare', 'cf-ray': '945aaefda9b13275-ICN', 'content-encoding': 'gzip'})]
[2025-05-26 13:56:02,598][DEBUG][request_id: req_011CPVYfwRqtvUcpcqZCZ5pr]
[2025-05-26 13:56:02,612][DEBUG][Request options: {'method': 'post', 'url': '/v1/messages', 'files': None, 'idempotency_key': 'stainless-python-retry-f7dd333b-f59c-4fe0-a51b-b4250d19688a', 'json_data': {'max_tokens': 1024, 'messages': [{'role': 'user', 'content': 'Retrieved document: \n\n page_content=\'□ 질의내용별 회신\n1. 지방자치단체와 근로계약을 체결한 근로자가 수행하는 업무가 국가\n또는 지방자치단체의 목적 사업 중의 하나로서 일반행정에 관한 규\n제와 집행사무가 아닌 시설물·장비유지관리, 현장공사, 현장지도 단\n속·감시 등 현업업무를 수행한다면 공공행정으로 판단하지 않고 현\n업의 업종으로 판단하여 산안법을 전부 적용할 수 있는지?\n○ 일반 행정사무와 근로형태나 노무관리가 명확히 구분되는 시설물·\n장비유지관리, 현장공사, 현장지도 단속·감시 등 현업업무는 별도로\' metadata={\'source\': \'/Users/ranifarm/python-work/adaptive-rag/vectorstore/data/지방자치단체 산안법 적용 (산재예방정책과-3018 (2018.07.06. 시행).pdf\', \'file_path\': \'/Users/ranifarm/python-work/adaptive-rag/vectorstore/data/지방자치단체 산안법 적용 (산재예방정책과-3018 (2018.07.06. 시행).pdf\', \'page\': 2, \'total_pages\': 3, \'Author\': \'dw\', \'CreationDate\': "D:20241223160641+09\'00\'", \'Creator\': \'Hwp 2022 12.0.0.2416\', \'ModDate\': "D:20241223160641+09\'00\'", \'PDFVersion\': \'1.4\', \'Producer\': \'Hancom PDF 1.3.0.545\'} \n\n User question: content=\'인사와 대화 시작에 관한 일반적인 표현\' additional_kwargs={} response_metadata={\'id\': \'msg_014MxmkSScGAz17bz5ipdeET\', \'model\': \'claude-3-5-sonnet-20240620\', \'stop_reason\': \'end_turn\', \'stop_sequence\': None, \'usage\': {\'cache_creation_input_tokens\': 0, \'cache_read_input_tokens\': 0, \'input_tokens\': 136, \'output_tokens\': 25, \'server_tool_use\': None, \'service_tier\': \'standard\'}, \'model_name\': \'claude-3-5-sonnet-20240620\'} id=\'run--af4df5a3-dda4-49d6-8279-2d9f99270b02-0\' usage_metadata={\'input_tokens\': 136, \'output_tokens\': 25, \'total_tokens\': 161, \'input_token_details\': {\'cache_read\': 0, \'cache_creation\': 0}}'}], 'model': 'claude-3-5-sonnet-20240620', 'system': "채점자는 검색된 문서와 사용자 질문의 관련성을 평가하는 채점자입니다. \\n \n문서에 사용자 질문과 관련된 키워드 또는 의미론적 의미가 포함되어 있으면 관련성이 있는 것으로 채점합니다. \\n\n잘못된 검색을 걸러내는 것이 목표입니다. \\n\n문서가 질문으로 해결할 수 있는 내용인지 여부를 나타내는 이진 점수 'Y' 또는 'N'을 부여합니다.\n", 'temperature': 0.0, 'tool_choice': {'type': 'tool', 'name': 'GradeDocuments'}, 'tools': [{'name': 'GradeDocuments', 'input_schema': {'properties': {'pass_yn': {'description': "문서가 질문으로 해결 가능한 내용인지에 따라 'Y' 또는 'N' 로 답합니다.", 'enum': ['Y', 'N'], 'type': 'string'}}, 'required': ['pass_yn'], 'type': 'object'}, 'description': '검색된 문서가 질문으로 해결 가능한 내용인지에 대한 여부를 판단합니다.'}]}}]
[2025-05-26 13:56:02,612][DEBUG][Sending HTTP Request: POST https://api.anthropic.com/v1/messages]
[2025-05-26 13:56:02,613][DEBUG][connect_tcp.started host='api.anthropic.com' port=443 local_address=None timeout=None socket_options=[(65535, 8, True), (6, 257, 60), (6, 258, 5)]]
[2025-05-26 13:56:02,626][DEBUG][connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x3aed7ebd0>]
[2025-05-26 13:56:02,626][DEBUG][start_tls.started ssl_context=<ssl.SSLContext object at 0x3aef8deb0> server_hostname='api.anthropic.com' timeout=None]
[2025-05-26 13:56:02,647][DEBUG][start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x3aed7eb90>]
[2025-05-26 13:56:02,648][DEBUG][send_request_headers.started request=<Request [b'POST']>]
[2025-05-26 13:56:02,648][DEBUG][send_request_headers.complete]
[2025-05-26 13:56:02,648][DEBUG][send_request_body.started request=<Request [b'POST']>]
[2025-05-26 13:56:02,648][DEBUG][send_request_body.complete]
[2025-05-26 13:56:02,648][DEBUG][receive_response_headers.started request=<Request [b'POST']>]
[2025-05-26 13:56:02,876][DEBUG][receive_response_headers.complete return_value=(b'HTTP/1.1', 429, b'Too Many Requests', [(b'Date', b'Mon, 26 May 2025 04:56:02 GMT'), (b'Content-Type', b'application/json'), (b'Content-Length', b'520'), (b'Connection', b'keep-alive'), (b'x-should-retry', b'true'), (b'anthropic-ratelimit-input-tokens-limit', b'20000'), (b'anthropic-ratelimit-input-tokens-remaining', b'19000'), (b'anthropic-ratelimit-input-tokens-reset', b'2025-05-26T04:56:05Z'), (b'anthropic-ratelimit-output-tokens-limit', b'4000'), (b'anthropic-ratelimit-output-tokens-remaining', b'4000'), (b'anthropic-ratelimit-output-tokens-reset', b'2025-05-26T04:56:02Z'), (b'anthropic-ratelimit-requests-limit', b'5'), (b'anthropic-ratelimit-requests-remaining', b'0'), (b'anthropic-ratelimit-requests-reset', b'2025-05-26T04:57:00Z'), (b'retry-after', b'10'), (b'anthropic-ratelimit-tokens-limit', b'24000'), (b'anthropic-ratelimit-tokens-remaining', b'23000'), (b'anthropic-ratelimit-tokens-reset', b'2025-05-26T04:56:02Z'), (b'request-id', b'req_011CPVYg4s51mHeCqWT2tRxw'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'anthropic-organization-id', b'22e5ed16-15d8-4ef0-a72f-fd41275bf557'), (b'via', b'1.1 google'), (b'cf-cache-status', b'DYNAMIC'), (b'X-Robots-Tag', b'none'), (b'Server', b'cloudflare'), (b'CF-RAY', b'945aaf088e51ea1f-ICN')])]
[2025-05-26 13:56:02,877][DEBUG][close.started]
[2025-05-26 13:56:02,877][DEBUG][close.complete]
[2025-05-26 13:56:02,879][DEBUG][receive_response_body.started request=<Request [b'POST']>]
[2025-05-26 13:56:02,879][DEBUG][receive_response_body.complete]
[2025-05-26 13:56:02,879][DEBUG][response_closed.started]
[2025-05-26 13:56:02,879][DEBUG][response_closed.complete]
[2025-05-26 13:56:02,879][DEBUG][HTTP Response: POST https://api.anthropic.com/v1/messages "429 Too Many Requests" Headers({'date': 'Mon, 26 May 2025 04:56:02 GMT', 'content-type': 'application/json', 'content-length': '520', 'connection': 'keep-alive', 'x-should-retry': 'true', 'anthropic-ratelimit-input-tokens-limit': '20000', 'anthropic-ratelimit-input-tokens-remaining': '19000', 'anthropic-ratelimit-input-tokens-reset': '2025-05-26T04:56:05Z', 'anthropic-ratelimit-output-tokens-limit': '4000', 'anthropic-ratelimit-output-tokens-remaining': '4000', 'anthropic-ratelimit-output-tokens-reset': '2025-05-26T04:56:02Z', 'anthropic-ratelimit-requests-limit': '5', 'anthropic-ratelimit-requests-remaining': '0', 'anthropic-ratelimit-requests-reset': '2025-05-26T04:57:00Z', 'retry-after': '10', 'anthropic-ratelimit-tokens-limit': '24000', 'anthropic-ratelimit-tokens-remaining': '23000', 'anthropic-ratelimit-tokens-reset': '2025-05-26T04:56:02Z', 'request-id': 'req_011CPVYg4s51mHeCqWT2tRxw', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'anthropic-organization-id': '22e5ed16-15d8-4ef0-a72f-fd41275bf557', 'via': '1.1 google', 'cf-cache-status': 'DYNAMIC', 'x-robots-tag': 'none', 'server': 'cloudflare', 'cf-ray': '945aaf088e51ea1f-ICN'})]
[2025-05-26 13:56:02,879][DEBUG][request_id: req_011CPVYg4s51mHeCqWT2tRxw]
[2025-05-26 13:56:02,879][DEBUG][Encountered httpx.HTTPStatusError]
Traceback (most recent call last):
  File "/Users/ranifarm/.conda/envs/adaptive-rag/lib/python3.11/site-packages/anthropic/_base_client.py", line 1065, in request
    response.raise_for_status()
  File "/Users/ranifarm/.conda/envs/adaptive-rag/lib/python3.11/site-packages/httpx/_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '429 Too Many Requests' for url 'https://api.anthropic.com/v1/messages'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429
[2025-05-26 13:56:02,880][DEBUG][Retrying as header `x-should-retry` is set to `true`]
[2025-05-26 13:56:02,880][DEBUG][2 retries left]
[2025-05-26 13:56:03,127][DEBUG][Sending compressed multipart request with context: trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=46b02680-1f54-487a-9b9d-5ca1697daed0; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=0c6b3f11-cf38-442f-985e-fab738665687; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=0c6b3f11-cf38-442f-985e-fab738665687; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=92ff6fe6-8b43-4969-bd08-412861c51582; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=d44105e0-8dc4-49d5-92b2-e2d43f350f61; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=7777a8a9-665d-407d-ad51-2ab17155a87d; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=7777a8a9-665d-407d-ad51-2ab17155a87d; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=a5c4d4ab-b524-4915-aaf1-2385d2d1c661]
[2025-05-26 13:56:03,343][DEBUG][https://api.smith.langchain.com:443 "POST /runs/multipart HTTP/1.1" 202 34]
[2025-05-26 13:56:12,885][DEBUG][Request options: {'method': 'post', 'url': '/v1/messages', 'files': None, 'idempotency_key': 'stainless-python-retry-f7dd333b-f59c-4fe0-a51b-b4250d19688a', 'json_data': {'max_tokens': 1024, 'messages': [{'role': 'user', 'content': 'Retrieved document: \n\n page_content=\'□ 질의내용별 회신\n1. 지방자치단체와 근로계약을 체결한 근로자가 수행하는 업무가 국가\n또는 지방자치단체의 목적 사업 중의 하나로서 일반행정에 관한 규\n제와 집행사무가 아닌 시설물·장비유지관리, 현장공사, 현장지도 단\n속·감시 등 현업업무를 수행한다면 공공행정으로 판단하지 않고 현\n업의 업종으로 판단하여 산안법을 전부 적용할 수 있는지?\n○ 일반 행정사무와 근로형태나 노무관리가 명확히 구분되는 시설물·\n장비유지관리, 현장공사, 현장지도 단속·감시 등 현업업무는 별도로\' metadata={\'source\': \'/Users/ranifarm/python-work/adaptive-rag/vectorstore/data/지방자치단체 산안법 적용 (산재예방정책과-3018 (2018.07.06. 시행).pdf\', \'file_path\': \'/Users/ranifarm/python-work/adaptive-rag/vectorstore/data/지방자치단체 산안법 적용 (산재예방정책과-3018 (2018.07.06. 시행).pdf\', \'page\': 2, \'total_pages\': 3, \'Author\': \'dw\', \'CreationDate\': "D:20241223160641+09\'00\'", \'Creator\': \'Hwp 2022 12.0.0.2416\', \'ModDate\': "D:20241223160641+09\'00\'", \'PDFVersion\': \'1.4\', \'Producer\': \'Hancom PDF 1.3.0.545\'} \n\n User question: content=\'인사와 대화 시작에 관한 일반적인 표현\' additional_kwargs={} response_metadata={\'id\': \'msg_014MxmkSScGAz17bz5ipdeET\', \'model\': \'claude-3-5-sonnet-20240620\', \'stop_reason\': \'end_turn\', \'stop_sequence\': None, \'usage\': {\'cache_creation_input_tokens\': 0, \'cache_read_input_tokens\': 0, \'input_tokens\': 136, \'output_tokens\': 25, \'server_tool_use\': None, \'service_tier\': \'standard\'}, \'model_name\': \'claude-3-5-sonnet-20240620\'} id=\'run--af4df5a3-dda4-49d6-8279-2d9f99270b02-0\' usage_metadata={\'input_tokens\': 136, \'output_tokens\': 25, \'total_tokens\': 161, \'input_token_details\': {\'cache_read\': 0, \'cache_creation\': 0}}'}], 'model': 'claude-3-5-sonnet-20240620', 'system': "채점자는 검색된 문서와 사용자 질문의 관련성을 평가하는 채점자입니다. \\n \n문서에 사용자 질문과 관련된 키워드 또는 의미론적 의미가 포함되어 있으면 관련성이 있는 것으로 채점합니다. \\n\n잘못된 검색을 걸러내는 것이 목표입니다. \\n\n문서가 질문으로 해결할 수 있는 내용인지 여부를 나타내는 이진 점수 'Y' 또는 'N'을 부여합니다.\n", 'temperature': 0.0, 'tool_choice': {'type': 'tool', 'name': 'GradeDocuments'}, 'tools': [{'name': 'GradeDocuments', 'input_schema': {'properties': {'pass_yn': {'description': "문서가 질문으로 해결 가능한 내용인지에 따라 'Y' 또는 'N' 로 답합니다.", 'enum': ['Y', 'N'], 'type': 'string'}}, 'required': ['pass_yn'], 'type': 'object'}, 'description': '검색된 문서가 질문으로 해결 가능한 내용인지에 대한 여부를 판단합니다.'}]}}]
[2025-05-26 13:56:12,888][DEBUG][Sending HTTP Request: POST https://api.anthropic.com/v1/messages]
[2025-05-26 13:56:12,888][DEBUG][close.started]
[2025-05-26 13:56:12,889][DEBUG][close.complete]
[2025-05-26 13:56:12,889][DEBUG][connect_tcp.started host='api.anthropic.com' port=443 local_address=None timeout=None socket_options=[(65535, 8, True), (6, 257, 60), (6, 258, 5)]]
[2025-05-26 13:56:12,905][DEBUG][connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x3aed6eb50>]
[2025-05-26 13:56:12,906][DEBUG][start_tls.started ssl_context=<ssl.SSLContext object at 0x3aef8deb0> server_hostname='api.anthropic.com' timeout=None]
[2025-05-26 13:56:12,923][DEBUG][start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x3aed6fc10>]
[2025-05-26 13:56:12,923][DEBUG][send_request_headers.started request=<Request [b'POST']>]
[2025-05-26 13:56:12,923][DEBUG][send_request_headers.complete]
[2025-05-26 13:56:12,923][DEBUG][send_request_body.started request=<Request [b'POST']>]
[2025-05-26 13:56:12,923][DEBUG][send_request_body.complete]
[2025-05-26 13:56:12,923][DEBUG][receive_response_headers.started request=<Request [b'POST']>]
[2025-05-26 13:56:14,037][DEBUG][receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 26 May 2025 04:56:14 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'anthropic-ratelimit-input-tokens-limit', b'20000'), (b'anthropic-ratelimit-input-tokens-remaining', b'19000'), (b'anthropic-ratelimit-input-tokens-reset', b'2025-05-26T04:56:17Z'), (b'anthropic-ratelimit-output-tokens-limit', b'4000'), (b'anthropic-ratelimit-output-tokens-remaining', b'4000'), (b'anthropic-ratelimit-output-tokens-reset', b'2025-05-26T04:56:13Z'), (b'anthropic-ratelimit-requests-limit', b'5'), (b'anthropic-ratelimit-requests-remaining', b'0'), (b'anthropic-ratelimit-requests-reset', b'2025-05-26T04:57:12Z'), (b'anthropic-ratelimit-tokens-limit', b'24000'), (b'anthropic-ratelimit-tokens-remaining', b'23000'), (b'anthropic-ratelimit-tokens-reset', b'2025-05-26T04:56:13Z'), (b'request-id', b'req_011CPVYgppkbmpNgyHS4sTq4'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'anthropic-organization-id', b'22e5ed16-15d8-4ef0-a72f-fd41275bf557'), (b'via', b'1.1 google'), (b'cf-cache-status', b'DYNAMIC'), (b'X-Robots-Tag', b'none'), (b'Server', b'cloudflare'), (b'CF-RAY', b'945aaf48c8ca3532-ICN'), (b'Content-Encoding', b'gzip')])]
[2025-05-26 13:56:14,037][DEBUG][receive_response_body.started request=<Request [b'POST']>]
[2025-05-26 13:56:14,038][DEBUG][receive_response_body.complete]
[2025-05-26 13:56:14,038][DEBUG][response_closed.started]
[2025-05-26 13:56:14,038][DEBUG][response_closed.complete]
[2025-05-26 13:56:14,038][DEBUG][HTTP Response: POST https://api.anthropic.com/v1/messages "200 OK" Headers({'date': 'Mon, 26 May 2025 04:56:14 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'anthropic-ratelimit-input-tokens-limit': '20000', 'anthropic-ratelimit-input-tokens-remaining': '19000', 'anthropic-ratelimit-input-tokens-reset': '2025-05-26T04:56:17Z', 'anthropic-ratelimit-output-tokens-limit': '4000', 'anthropic-ratelimit-output-tokens-remaining': '4000', 'anthropic-ratelimit-output-tokens-reset': '2025-05-26T04:56:13Z', 'anthropic-ratelimit-requests-limit': '5', 'anthropic-ratelimit-requests-remaining': '0', 'anthropic-ratelimit-requests-reset': '2025-05-26T04:57:12Z', 'anthropic-ratelimit-tokens-limit': '24000', 'anthropic-ratelimit-tokens-remaining': '23000', 'anthropic-ratelimit-tokens-reset': '2025-05-26T04:56:13Z', 'request-id': 'req_011CPVYgppkbmpNgyHS4sTq4', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'anthropic-organization-id': '22e5ed16-15d8-4ef0-a72f-fd41275bf557', 'via': '1.1 google', 'cf-cache-status': 'DYNAMIC', 'x-robots-tag': 'none', 'server': 'cloudflare', 'cf-ray': '945aaf48c8ca3532-ICN', 'content-encoding': 'gzip'})]
[2025-05-26 13:56:14,038][DEBUG][request_id: req_011CPVYgppkbmpNgyHS4sTq4]
[2025-05-26 13:56:14,055][DEBUG][Request options: {'method': 'post', 'url': '/v1/messages', 'files': None, 'idempotency_key': 'stainless-python-retry-fbdaadb6-97ba-41bd-bd21-861ad738621a', 'json_data': {'max_tokens': 1024, 'messages': [{'role': 'user', 'content': "content='인사와 대화 시작에 관한 일반적인 표현' additional_kwargs={} response_metadata={'id': 'msg_014MxmkSScGAz17bz5ipdeET', 'model': 'claude-3-5-sonnet-20240620', 'stop_reason': 'end_turn', 'stop_sequence': None, 'usage': {'cache_creation_input_tokens': 0, 'cache_read_input_tokens': 0, 'input_tokens': 136, 'output_tokens': 25, 'server_tool_use': None, 'service_tier': 'standard'}, 'model_name': 'claude-3-5-sonnet-20240620'} id='run--af4df5a3-dda4-49d6-8279-2d9f99270b02-0' usage_metadata={'input_tokens': 136, 'output_tokens': 25, 'total_tokens': 161, 'input_token_details': {'cache_read': 0, 'cache_creation': 0}}"}], 'model': 'claude-3-5-sonnet-20240620', 'system': '입력된 질문을 벡터 검색에 최적화된 더 나은 버전으로 변환하는 질문 재작성기입니다. 입력을 보고 근본적인 의미론적 의도/의미에 대해 추론해서 질문을 다시 작성해주세요.\n다른 내용은 생성하지 말고 수정된 질문만 생성해주세요.', 'temperature': 0.0}}]
[2025-05-26 13:56:14,055][DEBUG][Sending HTTP Request: POST https://api.anthropic.com/v1/messages]
[2025-05-26 13:56:14,055][DEBUG][connect_tcp.started host='api.anthropic.com' port=443 local_address=None timeout=None socket_options=[(65535, 8, True), (6, 257, 60), (6, 258, 5)]]
[2025-05-26 13:56:14,066][DEBUG][connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x3aed813d0>]
[2025-05-26 13:56:14,066][DEBUG][start_tls.started ssl_context=<ssl.SSLContext object at 0x306a67650> server_hostname='api.anthropic.com' timeout=None]
[2025-05-26 13:56:14,080][DEBUG][start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x3aed81390>]
[2025-05-26 13:56:14,080][DEBUG][send_request_headers.started request=<Request [b'POST']>]
[2025-05-26 13:56:14,080][DEBUG][send_request_headers.complete]
[2025-05-26 13:56:14,080][DEBUG][send_request_body.started request=<Request [b'POST']>]
[2025-05-26 13:56:14,080][DEBUG][send_request_body.complete]
[2025-05-26 13:56:14,080][DEBUG][receive_response_headers.started request=<Request [b'POST']>]
[2025-05-26 13:56:14,576][DEBUG][receive_response_headers.complete return_value=(b'HTTP/1.1', 429, b'Too Many Requests', [(b'Date', b'Mon, 26 May 2025 04:56:14 GMT'), (b'Content-Type', b'application/json'), (b'Content-Length', b'520'), (b'Connection', b'keep-alive'), (b'x-should-retry', b'true'), (b'anthropic-ratelimit-input-tokens-limit', b'20000'), (b'anthropic-ratelimit-input-tokens-remaining', b'19000'), (b'anthropic-ratelimit-input-tokens-reset', b'2025-05-26T04:56:17Z'), (b'anthropic-ratelimit-output-tokens-limit', b'4000'), (b'anthropic-ratelimit-output-tokens-remaining', b'4000'), (b'anthropic-ratelimit-output-tokens-reset', b'2025-05-26T04:56:14Z'), (b'anthropic-ratelimit-requests-limit', b'5'), (b'anthropic-ratelimit-requests-remaining', b'0'), (b'anthropic-ratelimit-requests-reset', b'2025-05-26T04:57:12Z'), (b'retry-after', b'10'), (b'anthropic-ratelimit-tokens-limit', b'24000'), (b'anthropic-ratelimit-tokens-remaining', b'23000'), (b'anthropic-ratelimit-tokens-reset', b'2025-05-26T04:56:14Z'), (b'request-id', b'req_011CPVYgvHAmMWpsibhmAWFp'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'anthropic-organization-id', b'22e5ed16-15d8-4ef0-a72f-fd41275bf557'), (b'via', b'1.1 google'), (b'cf-cache-status', b'DYNAMIC'), (b'X-Robots-Tag', b'none'), (b'Server', b'cloudflare'), (b'CF-RAY', b'945aaf500c4dea28-ICN')])]
[2025-05-26 13:56:14,578][DEBUG][receive_response_body.started request=<Request [b'POST']>]
[2025-05-26 13:56:14,579][DEBUG][receive_response_body.complete]
[2025-05-26 13:56:14,579][DEBUG][response_closed.started]
[2025-05-26 13:56:14,579][DEBUG][response_closed.complete]
[2025-05-26 13:56:14,579][DEBUG][HTTP Response: POST https://api.anthropic.com/v1/messages "429 Too Many Requests" Headers({'date': 'Mon, 26 May 2025 04:56:14 GMT', 'content-type': 'application/json', 'content-length': '520', 'connection': 'keep-alive', 'x-should-retry': 'true', 'anthropic-ratelimit-input-tokens-limit': '20000', 'anthropic-ratelimit-input-tokens-remaining': '19000', 'anthropic-ratelimit-input-tokens-reset': '2025-05-26T04:56:17Z', 'anthropic-ratelimit-output-tokens-limit': '4000', 'anthropic-ratelimit-output-tokens-remaining': '4000', 'anthropic-ratelimit-output-tokens-reset': '2025-05-26T04:56:14Z', 'anthropic-ratelimit-requests-limit': '5', 'anthropic-ratelimit-requests-remaining': '0', 'anthropic-ratelimit-requests-reset': '2025-05-26T04:57:12Z', 'retry-after': '10', 'anthropic-ratelimit-tokens-limit': '24000', 'anthropic-ratelimit-tokens-remaining': '23000', 'anthropic-ratelimit-tokens-reset': '2025-05-26T04:56:14Z', 'request-id': 'req_011CPVYgvHAmMWpsibhmAWFp', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'anthropic-organization-id': '22e5ed16-15d8-4ef0-a72f-fd41275bf557', 'via': '1.1 google', 'cf-cache-status': 'DYNAMIC', 'x-robots-tag': 'none', 'server': 'cloudflare', 'cf-ray': '945aaf500c4dea28-ICN'})]
[2025-05-26 13:56:14,580][DEBUG][request_id: req_011CPVYgvHAmMWpsibhmAWFp]
[2025-05-26 13:56:14,580][DEBUG][Encountered httpx.HTTPStatusError]
Traceback (most recent call last):
  File "/Users/ranifarm/.conda/envs/adaptive-rag/lib/python3.11/site-packages/anthropic/_base_client.py", line 1065, in request
    response.raise_for_status()
  File "/Users/ranifarm/.conda/envs/adaptive-rag/lib/python3.11/site-packages/httpx/_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '429 Too Many Requests' for url 'https://api.anthropic.com/v1/messages'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429
[2025-05-26 13:56:14,580][DEBUG][Retrying as header `x-should-retry` is set to `true`]
[2025-05-26 13:56:14,580][DEBUG][2 retries left]
[2025-05-26 13:56:14,584][DEBUG][Sending compressed multipart request with context: trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=a5c4d4ab-b524-4915-aaf1-2385d2d1c661; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=c99533c6-869a-4542-9943-6d47837493ff; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=c99533c6-869a-4542-9943-6d47837493ff; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=d44105e0-8dc4-49d5-92b2-e2d43f350f61; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=4b41664c-b532-4c6f-8cec-baaecd084528; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=4b41664c-b532-4c6f-8cec-baaecd084528; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=9c80865c-0a5d-4275-bfc1-820b5aee7470; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=7478eaac-2c94-4e69-82d9-3319078e8fe1; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=bfaf529f-17ff-4466-837b-e33e94cf1d0a; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=dc741942-550b-4e52-9822-d9800a240394; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=dc741942-550b-4e52-9822-d9800a240394; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=65989647-9bef-425f-b559-dab20f043d2e]
[2025-05-26 13:56:14,885][DEBUG][https://api.smith.langchain.com:443 "POST /runs/multipart HTTP/1.1" 202 34]
[2025-05-26 13:56:24,581][DEBUG][Request options: {'method': 'post', 'url': '/v1/messages', 'files': None, 'idempotency_key': 'stainless-python-retry-fbdaadb6-97ba-41bd-bd21-861ad738621a', 'json_data': {'max_tokens': 1024, 'messages': [{'role': 'user', 'content': "content='인사와 대화 시작에 관한 일반적인 표현' additional_kwargs={} response_metadata={'id': 'msg_014MxmkSScGAz17bz5ipdeET', 'model': 'claude-3-5-sonnet-20240620', 'stop_reason': 'end_turn', 'stop_sequence': None, 'usage': {'cache_creation_input_tokens': 0, 'cache_read_input_tokens': 0, 'input_tokens': 136, 'output_tokens': 25, 'server_tool_use': None, 'service_tier': 'standard'}, 'model_name': 'claude-3-5-sonnet-20240620'} id='run--af4df5a3-dda4-49d6-8279-2d9f99270b02-0' usage_metadata={'input_tokens': 136, 'output_tokens': 25, 'total_tokens': 161, 'input_token_details': {'cache_read': 0, 'cache_creation': 0}}"}], 'model': 'claude-3-5-sonnet-20240620', 'system': '입력된 질문을 벡터 검색에 최적화된 더 나은 버전으로 변환하는 질문 재작성기입니다. 입력을 보고 근본적인 의미론적 의도/의미에 대해 추론해서 질문을 다시 작성해주세요.\n다른 내용은 생성하지 말고 수정된 질문만 생성해주세요.', 'temperature': 0.0}}]
[2025-05-26 13:56:24,582][DEBUG][Sending HTTP Request: POST https://api.anthropic.com/v1/messages]
[2025-05-26 13:56:24,582][DEBUG][close.started]
[2025-05-26 13:56:24,582][DEBUG][close.complete]
[2025-05-26 13:56:24,583][DEBUG][connect_tcp.started host='api.anthropic.com' port=443 local_address=None timeout=None socket_options=[(65535, 8, True), (6, 257, 60), (6, 258, 5)]]
[2025-05-26 13:56:24,595][DEBUG][connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x3aed83610>]
[2025-05-26 13:56:24,595][DEBUG][start_tls.started ssl_context=<ssl.SSLContext object at 0x306a67650> server_hostname='api.anthropic.com' timeout=None]
[2025-05-26 13:56:24,610][DEBUG][start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x3aed83510>]
[2025-05-26 13:56:24,610][DEBUG][send_request_headers.started request=<Request [b'POST']>]
[2025-05-26 13:56:24,610][DEBUG][send_request_headers.complete]
[2025-05-26 13:56:24,610][DEBUG][send_request_body.started request=<Request [b'POST']>]
[2025-05-26 13:56:24,611][DEBUG][send_request_body.complete]
[2025-05-26 13:56:24,611][DEBUG][receive_response_headers.started request=<Request [b'POST']>]
[2025-05-26 13:56:25,740][DEBUG][receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 26 May 2025 04:56:25 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'anthropic-ratelimit-input-tokens-limit', b'20000'), (b'anthropic-ratelimit-input-tokens-remaining', b'20000'), (b'anthropic-ratelimit-input-tokens-reset', b'2025-05-26T04:56:25Z'), (b'anthropic-ratelimit-output-tokens-limit', b'4000'), (b'anthropic-ratelimit-output-tokens-remaining', b'4000'), (b'anthropic-ratelimit-output-tokens-reset', b'2025-05-26T04:56:25Z'), (b'anthropic-ratelimit-requests-limit', b'5'), (b'anthropic-ratelimit-requests-remaining', b'0'), (b'anthropic-ratelimit-requests-reset', b'2025-05-26T04:57:24Z'), (b'anthropic-ratelimit-tokens-limit', b'24000'), (b'anthropic-ratelimit-tokens-remaining', b'24000'), (b'anthropic-ratelimit-tokens-reset', b'2025-05-26T04:56:25Z'), (b'request-id', b'req_011CPVYhgmbQPUg4M2sDakjw'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'anthropic-organization-id', b'22e5ed16-15d8-4ef0-a72f-fd41275bf557'), (b'via', b'1.1 google'), (b'cf-cache-status', b'DYNAMIC'), (b'X-Robots-Tag', b'none'), (b'Server', b'cloudflare'), (b'CF-RAY', b'945aaf91d957d1e6-ICN'), (b'Content-Encoding', b'gzip')])]
[2025-05-26 13:56:25,741][DEBUG][receive_response_body.started request=<Request [b'POST']>]
[2025-05-26 13:56:25,741][DEBUG][receive_response_body.complete]
[2025-05-26 13:56:25,741][DEBUG][response_closed.started]
[2025-05-26 13:56:25,741][DEBUG][response_closed.complete]
[2025-05-26 13:56:25,741][DEBUG][HTTP Response: POST https://api.anthropic.com/v1/messages "200 OK" Headers({'date': 'Mon, 26 May 2025 04:56:25 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'anthropic-ratelimit-input-tokens-limit': '20000', 'anthropic-ratelimit-input-tokens-remaining': '20000', 'anthropic-ratelimit-input-tokens-reset': '2025-05-26T04:56:25Z', 'anthropic-ratelimit-output-tokens-limit': '4000', 'anthropic-ratelimit-output-tokens-remaining': '4000', 'anthropic-ratelimit-output-tokens-reset': '2025-05-26T04:56:25Z', 'anthropic-ratelimit-requests-limit': '5', 'anthropic-ratelimit-requests-remaining': '0', 'anthropic-ratelimit-requests-reset': '2025-05-26T04:57:24Z', 'anthropic-ratelimit-tokens-limit': '24000', 'anthropic-ratelimit-tokens-remaining': '24000', 'anthropic-ratelimit-tokens-reset': '2025-05-26T04:56:25Z', 'request-id': 'req_011CPVYhgmbQPUg4M2sDakjw', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'anthropic-organization-id': '22e5ed16-15d8-4ef0-a72f-fd41275bf557', 'via': '1.1 google', 'cf-cache-status': 'DYNAMIC', 'x-robots-tag': 'none', 'server': 'cloudflare', 'cf-ray': '945aaf91d957d1e6-ICN', 'content-encoding': 'gzip'})]
[2025-05-26 13:56:25,741][DEBUG][request_id: req_011CPVYhgmbQPUg4M2sDakjw]
[2025-05-26 13:56:25,750][DEBUG][close.started]
[2025-05-26 13:56:25,751][DEBUG][close.complete]
[2025-05-26 13:56:25,783][DEBUG][close.started]
[2025-05-26 13:56:25,784][DEBUG][close.complete]
[2025-05-26 13:56:25,784][DEBUG][close.started]
[2025-05-26 13:56:25,784][DEBUG][close.complete]
[2025-05-26 13:56:26,153][DEBUG][https://huggingface.co:443 "HEAD /BAAI/bge-m3/resolve/main/modules.json HTTP/1.1" 200 0]
[2025-05-26 13:56:26,255][DEBUG][Sending compressed multipart request with context: trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=65989647-9bef-425f-b559-dab20f043d2e; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=bfaf529f-17ff-4466-837b-e33e94cf1d0a; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=7478eaac-2c94-4e69-82d9-3319078e8fe1; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=974c1af2-e8a0-4fe3-8b4b-f6de706609c6]
[2025-05-26 13:56:26,363][DEBUG][https://huggingface.co:443 "HEAD /BAAI/bge-m3/resolve/main/config_sentence_transformers.json HTTP/1.1" 200 0]
[2025-05-26 13:56:26,465][DEBUG][https://api.smith.langchain.com:443 "POST /runs/multipart HTTP/1.1" 202 34]
[2025-05-26 13:56:26,609][DEBUG][https://huggingface.co:443 "HEAD /BAAI/bge-m3/resolve/main/README.md HTTP/1.1" 200 0]
[2025-05-26 13:56:26,823][DEBUG][https://huggingface.co:443 "HEAD /BAAI/bge-m3/resolve/main/modules.json HTTP/1.1" 200 0]
[2025-05-26 13:56:27,067][DEBUG][https://huggingface.co:443 "HEAD /BAAI/bge-m3/resolve/main/sentence_bert_config.json HTTP/1.1" 200 0]
[2025-05-26 13:56:27,277][DEBUG][https://huggingface.co:443 "HEAD /BAAI/bge-m3/resolve/main/adapter_config.json HTTP/1.1" 404 0]
[2025-05-26 13:56:27,487][DEBUG][https://huggingface.co:443 "HEAD /BAAI/bge-m3/resolve/main/config.json HTTP/1.1" 200 0]
[2025-05-26 13:56:27,705][DEBUG][https://huggingface.co:443 "HEAD /BAAI/bge-m3/resolve/main/model.safetensors HTTP/1.1" 404 0]
[2025-05-26 13:56:27,712][DEBUG][Starting new HTTPS connection (1): huggingface.co:443]
[2025-05-26 13:56:27,953][DEBUG][https://huggingface.co:443 "GET /api/models/BAAI/bge-m3 HTTP/1.1" 200 5209]
[2025-05-26 13:56:28,369][DEBUG][https://huggingface.co:443 "GET /api/models/BAAI/bge-m3/commits/main HTTP/1.1" 200 9525]
[2025-05-26 13:56:28,774][DEBUG][https://huggingface.co:443 "GET /api/models/BAAI/bge-m3/discussions?p=0 HTTP/1.1" 200 30448]
[2025-05-26 13:56:29,112][DEBUG][https://huggingface.co:443 "GET /api/models/BAAI/bge-m3/commits/refs%2Fpr%2F118 HTTP/1.1" 200 10490]
[2025-05-26 13:56:29,333][DEBUG][https://huggingface.co:443 "HEAD /BAAI/bge-m3/resolve/refs%2Fpr%2F118/model.safetensors.index.json HTTP/1.1" 404 0]
[2025-05-26 13:56:29,361][DEBUG][https://huggingface.co:443 "HEAD /BAAI/bge-m3/resolve/main/tokenizer_config.json HTTP/1.1" 200 0]
[2025-05-26 13:56:29,538][DEBUG][https://huggingface.co:443 "HEAD /BAAI/bge-m3/resolve/refs%2Fpr%2F118/model.safetensors HTTP/1.1" 302 0]
[2025-05-26 13:56:29,691][DEBUG][https://huggingface.co:443 "GET /api/models/BAAI/bge-m3/tree/main/additional_chat_templates?recursive=False&expand=False HTTP/1.1" 404 64]
[2025-05-26 13:56:31,216][DEBUG][https://huggingface.co:443 "GET /api/models/BAAI/bge-m3/revision/main HTTP/1.1" 200 5209]
[2025-05-26 13:56:31,475][DEBUG][https://huggingface.co:443 "GET /api/models/BAAI/bge-m3 HTTP/1.1" 200 5209]
[2025-05-26 13:56:37,402][DEBUG][Sending compressed multipart request with context: trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=e6f74b88-796f-47ad-b004-bbc3d6e25df2]
[2025-05-26 13:56:37,448][DEBUG][Request options: {'method': 'post', 'url': '/v1/messages', 'files': None, 'idempotency_key': 'stainless-python-retry-c5c4dcc3-b26f-46fb-b34d-908c9036ff06', 'json_data': {'max_tokens': 1024, 'messages': [{'role': 'user', 'content': 'Retrieved document: \n\n page_content=\'되어 있더라도 출장소, 사업소, 지점 등이 업무처리 능력 등을 감안할 때\n하나의 사업장이라고 말할 정도의 독립성이 없으면 직근 상위조직(기구)와\n일괄하여 하나의 사업장으로 보아야 할 것임(산재예방정책과-7065, ‘12.7.30)\n□ 지방자치단체 산안법 적용 검토\n○ ｢한국표준산업분류｣에 따르면 공공행정은 일반 공공행정, 재정\n및 경제정책 행정, 정부기관 일반 보조 행정 등 행정에 관한 규제와\n집행을 위한 행정사무 업무만을 의미함\n- 지방자치단체가 행하는 일반 행정사무는 공공행정에 해당하므로\' metadata={\'source\': \'/Users/ranifarm/python-work/adaptive-rag/vectorstore/data/지방자치단체 산안법 적용 (산재예방정책과-3018 (2018.07.06. 시행).pdf\', \'file_path\': \'/Users/ranifarm/python-work/adaptive-rag/vectorstore/data/지방자치단체 산안법 적용 (산재예방정책과-3018 (2018.07.06. 시행).pdf\', \'page\': 0, \'total_pages\': 3, \'Author\': \'dw\', \'CreationDate\': "D:20241223160641+09\'00\'", \'Creator\': \'Hwp 2022 12.0.0.2416\', \'ModDate\': "D:20241223160641+09\'00\'", \'PDFVersion\': \'1.4\', \'Producer\': \'Hancom PDF 1.3.0.545\'} \n\n User question: content=\'일상적인 인사와 대화 시작 표현들\' additional_kwargs={} response_metadata={\'id\': \'msg_01MLxrxAFTEFW6Hy1t3jDm62\', \'model\': \'claude-3-5-sonnet-20240620\', \'stop_reason\': \'end_turn\', \'stop_sequence\': None, \'usage\': {\'cache_creation_input_tokens\': 0, \'cache_read_input_tokens\': 0, \'input_tokens\': 405, \'output_tokens\': 22, \'server_tool_use\': None, \'service_tier\': \'standard\'}, \'model_name\': \'claude-3-5-sonnet-20240620\'} id=\'run--65989647-9bef-425f-b559-dab20f043d2e-0\' usage_metadata={\'input_tokens\': 405, \'output_tokens\': 22, \'total_tokens\': 427, \'input_token_details\': {\'cache_read\': 0, \'cache_creation\': 0}}'}], 'model': 'claude-3-5-sonnet-20240620', 'system': "채점자는 검색된 문서와 사용자 질문의 관련성을 평가하는 채점자입니다. \\n \n문서에 사용자 질문과 관련된 키워드 또는 의미론적 의미가 포함되어 있으면 관련성이 있는 것으로 채점합니다. \\n\n잘못된 검색을 걸러내는 것이 목표입니다. \\n\n문서가 질문으로 해결할 수 있는 내용인지 여부를 나타내는 이진 점수 'Y' 또는 'N'을 부여합니다.\n", 'temperature': 0.0, 'tool_choice': {'type': 'tool', 'name': 'GradeDocuments'}, 'tools': [{'name': 'GradeDocuments', 'input_schema': {'properties': {'pass_yn': {'description': "문서가 질문으로 해결 가능한 내용인지에 따라 'Y' 또는 'N' 로 답합니다.", 'enum': ['Y', 'N'], 'type': 'string'}}, 'required': ['pass_yn'], 'type': 'object'}, 'description': '검색된 문서가 질문으로 해결 가능한 내용인지에 대한 여부를 판단합니다.'}]}}]
[2025-05-26 13:56:37,449][DEBUG][Sending HTTP Request: POST https://api.anthropic.com/v1/messages]
[2025-05-26 13:56:37,449][DEBUG][connect_tcp.started host='api.anthropic.com' port=443 local_address=None timeout=None socket_options=[(65535, 8, True), (6, 257, 60), (6, 258, 5)]]
[2025-05-26 13:56:37,464][DEBUG][connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x306e23610>]
[2025-05-26 13:56:37,464][DEBUG][start_tls.started ssl_context=<ssl.SSLContext object at 0x30686af90> server_hostname='api.anthropic.com' timeout=None]
[2025-05-26 13:56:37,480][DEBUG][start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x31d8800d0>]
[2025-05-26 13:56:37,480][DEBUG][send_request_headers.started request=<Request [b'POST']>]
[2025-05-26 13:56:37,480][DEBUG][send_request_headers.complete]
[2025-05-26 13:56:37,480][DEBUG][send_request_body.started request=<Request [b'POST']>]
[2025-05-26 13:56:37,480][DEBUG][send_request_body.complete]
[2025-05-26 13:56:37,480][DEBUG][receive_response_headers.started request=<Request [b'POST']>]
[2025-05-26 13:56:37,603][DEBUG][https://api.smith.langchain.com:443 "POST /runs/multipart HTTP/1.1" 202 34]
[2025-05-26 13:56:38,150][DEBUG][Sending compressed multipart request with context: trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=e6f74b88-796f-47ad-b004-bbc3d6e25df2; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=974c1af2-e8a0-4fe3-8b4b-f6de706609c6; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=4da43205-bd7e-4bd9-b355-bcfcd52a3e3b; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=c09d3098-690c-4034-840d-0e5a5035a3a7; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=6ef3cd40-71ad-4426-bf45-2de35b958a05; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=6ef3cd40-71ad-4426-bf45-2de35b958a05; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=35a10c38-5b87-4389-9a10-caa8cd111178]
[2025-05-26 13:56:38,366][DEBUG][https://api.smith.langchain.com:443 "POST /runs/multipart HTTP/1.1" 202 34]
[2025-05-26 13:56:38,603][DEBUG][receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 26 May 2025 04:56:38 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'anthropic-ratelimit-input-tokens-limit', b'20000'), (b'anthropic-ratelimit-input-tokens-remaining', b'19000'), (b'anthropic-ratelimit-input-tokens-reset', b'2025-05-26T04:56:42Z'), (b'anthropic-ratelimit-output-tokens-limit', b'4000'), (b'anthropic-ratelimit-output-tokens-remaining', b'4000'), (b'anthropic-ratelimit-output-tokens-reset', b'2025-05-26T04:56:38Z'), (b'anthropic-ratelimit-requests-limit', b'5'), (b'anthropic-ratelimit-requests-remaining', b'0'), (b'anthropic-ratelimit-requests-reset', b'2025-05-26T04:57:36Z'), (b'anthropic-ratelimit-tokens-limit', b'24000'), (b'anthropic-ratelimit-tokens-remaining', b'23000'), (b'anthropic-ratelimit-tokens-reset', b'2025-05-26T04:56:38Z'), (b'request-id', b'req_011CPVYidoHEYrDHvjw9iMw4'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'anthropic-organization-id', b'22e5ed16-15d8-4ef0-a72f-fd41275bf557'), (b'via', b'1.1 google'), (b'cf-cache-status', b'DYNAMIC'), (b'X-Robots-Tag', b'none'), (b'Server', b'cloudflare'), (b'CF-RAY', b'945aafe249853170-ICN'), (b'Content-Encoding', b'gzip')])]
[2025-05-26 13:56:38,607][DEBUG][receive_response_body.started request=<Request [b'POST']>]
[2025-05-26 13:56:38,607][DEBUG][receive_response_body.complete]
[2025-05-26 13:56:38,608][DEBUG][response_closed.started]
[2025-05-26 13:56:38,608][DEBUG][response_closed.complete]
[2025-05-26 13:56:38,608][DEBUG][HTTP Response: POST https://api.anthropic.com/v1/messages "200 OK" Headers({'date': 'Mon, 26 May 2025 04:56:38 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'anthropic-ratelimit-input-tokens-limit': '20000', 'anthropic-ratelimit-input-tokens-remaining': '19000', 'anthropic-ratelimit-input-tokens-reset': '2025-05-26T04:56:42Z', 'anthropic-ratelimit-output-tokens-limit': '4000', 'anthropic-ratelimit-output-tokens-remaining': '4000', 'anthropic-ratelimit-output-tokens-reset': '2025-05-26T04:56:38Z', 'anthropic-ratelimit-requests-limit': '5', 'anthropic-ratelimit-requests-remaining': '0', 'anthropic-ratelimit-requests-reset': '2025-05-26T04:57:36Z', 'anthropic-ratelimit-tokens-limit': '24000', 'anthropic-ratelimit-tokens-remaining': '23000', 'anthropic-ratelimit-tokens-reset': '2025-05-26T04:56:38Z', 'request-id': 'req_011CPVYidoHEYrDHvjw9iMw4', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'anthropic-organization-id': '22e5ed16-15d8-4ef0-a72f-fd41275bf557', 'via': '1.1 google', 'cf-cache-status': 'DYNAMIC', 'x-robots-tag': 'none', 'server': 'cloudflare', 'cf-ray': '945aafe249853170-ICN', 'content-encoding': 'gzip'})]
[2025-05-26 13:56:38,611][DEBUG][request_id: req_011CPVYidoHEYrDHvjw9iMw4]
[2025-05-26 13:56:38,638][DEBUG][Request options: {'method': 'post', 'url': '/v1/messages', 'files': None, 'idempotency_key': 'stainless-python-retry-36b52421-11ad-44f5-81e9-1084ae78d1f8', 'json_data': {'max_tokens': 1024, 'messages': [{'role': 'user', 'content': 'Retrieved document: \n\n page_content=\'하나의 적용단위로 판단할 때 업종판단은 가장 많은 비율을 차지\n하는 현업업무종사자의 업태와 유사한 업종을 기준으로 판단함\n- 2 -\' metadata={\'source\': \'/Users/ranifarm/python-work/adaptive-rag/vectorstore/data/지방자치단체 산안법 적용 (산재예방정책과-3018 (2018.07.06. 시행).pdf\', \'file_path\': \'/Users/ranifarm/python-work/adaptive-rag/vectorstore/data/지방자치단체 산안법 적용 (산재예방정책과-3018 (2018.07.06. 시행).pdf\', \'page\': 1, \'total_pages\': 3, \'Author\': \'dw\', \'CreationDate\': "D:20241223160641+09\'00\'", \'Creator\': \'Hwp 2022 12.0.0.2416\', \'ModDate\': "D:20241223160641+09\'00\'", \'PDFVersion\': \'1.4\', \'Producer\': \'Hancom PDF 1.3.0.545\'} \n\n User question: content=\'일상적인 인사와 대화 시작 표현들\' additional_kwargs={} response_metadata={\'id\': \'msg_01MLxrxAFTEFW6Hy1t3jDm62\', \'model\': \'claude-3-5-sonnet-20240620\', \'stop_reason\': \'end_turn\', \'stop_sequence\': None, \'usage\': {\'cache_creation_input_tokens\': 0, \'cache_read_input_tokens\': 0, \'input_tokens\': 405, \'output_tokens\': 22, \'server_tool_use\': None, \'service_tier\': \'standard\'}, \'model_name\': \'claude-3-5-sonnet-20240620\'} id=\'run--65989647-9bef-425f-b559-dab20f043d2e-0\' usage_metadata={\'input_tokens\': 405, \'output_tokens\': 22, \'total_tokens\': 427, \'input_token_details\': {\'cache_read\': 0, \'cache_creation\': 0}}'}], 'model': 'claude-3-5-sonnet-20240620', 'system': "채점자는 검색된 문서와 사용자 질문의 관련성을 평가하는 채점자입니다. \\n \n문서에 사용자 질문과 관련된 키워드 또는 의미론적 의미가 포함되어 있으면 관련성이 있는 것으로 채점합니다. \\n\n잘못된 검색을 걸러내는 것이 목표입니다. \\n\n문서가 질문으로 해결할 수 있는 내용인지 여부를 나타내는 이진 점수 'Y' 또는 'N'을 부여합니다.\n", 'temperature': 0.0, 'tool_choice': {'type': 'tool', 'name': 'GradeDocuments'}, 'tools': [{'name': 'GradeDocuments', 'input_schema': {'properties': {'pass_yn': {'description': "문서가 질문으로 해결 가능한 내용인지에 따라 'Y' 또는 'N' 로 답합니다.", 'enum': ['Y', 'N'], 'type': 'string'}}, 'required': ['pass_yn'], 'type': 'object'}, 'description': '검색된 문서가 질문으로 해결 가능한 내용인지에 대한 여부를 판단합니다.'}]}}]
[2025-05-26 13:56:38,639][DEBUG][Sending HTTP Request: POST https://api.anthropic.com/v1/messages]
[2025-05-26 13:56:38,639][DEBUG][connect_tcp.started host='api.anthropic.com' port=443 local_address=None timeout=None socket_options=[(65535, 8, True), (6, 257, 60), (6, 258, 5)]]
[2025-05-26 13:56:38,655][DEBUG][connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x31d861590>]
[2025-05-26 13:56:38,655][DEBUG][start_tls.started ssl_context=<ssl.SSLContext object at 0x30686b2f0> server_hostname='api.anthropic.com' timeout=None]
[2025-05-26 13:56:38,669][DEBUG][start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x31d861410>]
[2025-05-26 13:56:38,669][DEBUG][send_request_headers.started request=<Request [b'POST']>]
[2025-05-26 13:56:38,669][DEBUG][send_request_headers.complete]
[2025-05-26 13:56:38,669][DEBUG][send_request_body.started request=<Request [b'POST']>]
[2025-05-26 13:56:38,669][DEBUG][send_request_body.complete]
[2025-05-26 13:56:38,669][DEBUG][receive_response_headers.started request=<Request [b'POST']>]
[2025-05-26 13:56:38,951][DEBUG][receive_response_headers.complete return_value=(b'HTTP/1.1', 429, b'Too Many Requests', [(b'Date', b'Mon, 26 May 2025 04:56:38 GMT'), (b'Content-Type', b'application/json'), (b'Content-Length', b'520'), (b'Connection', b'keep-alive'), (b'x-should-retry', b'true'), (b'anthropic-ratelimit-input-tokens-limit', b'20000'), (b'anthropic-ratelimit-input-tokens-remaining', b'19000'), (b'anthropic-ratelimit-input-tokens-reset', b'2025-05-26T04:56:42Z'), (b'anthropic-ratelimit-output-tokens-limit', b'4000'), (b'anthropic-ratelimit-output-tokens-remaining', b'4000'), (b'anthropic-ratelimit-output-tokens-reset', b'2025-05-26T04:56:38Z'), (b'anthropic-ratelimit-requests-limit', b'5'), (b'anthropic-ratelimit-requests-remaining', b'0'), (b'anthropic-ratelimit-requests-reset', b'2025-05-26T04:57:36Z'), (b'retry-after', b'10'), (b'anthropic-ratelimit-tokens-limit', b'24000'), (b'anthropic-ratelimit-tokens-remaining', b'23000'), (b'anthropic-ratelimit-tokens-reset', b'2025-05-26T04:56:38Z'), (b'request-id', b'req_011CPVYij5mqU5JVoiCRNtDp'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'anthropic-organization-id', b'22e5ed16-15d8-4ef0-a72f-fd41275bf557'), (b'via', b'1.1 google'), (b'cf-cache-status', b'DYNAMIC'), (b'X-Robots-Tag', b'none'), (b'Server', b'cloudflare'), (b'CF-RAY', b'945aafe9ae07d1d9-ICN')])]
[2025-05-26 13:56:38,954][DEBUG][receive_response_body.started request=<Request [b'POST']>]
[2025-05-26 13:56:38,954][DEBUG][receive_response_body.complete]
[2025-05-26 13:56:38,954][DEBUG][response_closed.started]
[2025-05-26 13:56:38,954][DEBUG][response_closed.complete]
[2025-05-26 13:56:38,955][DEBUG][HTTP Response: POST https://api.anthropic.com/v1/messages "429 Too Many Requests" Headers({'date': 'Mon, 26 May 2025 04:56:38 GMT', 'content-type': 'application/json', 'content-length': '520', 'connection': 'keep-alive', 'x-should-retry': 'true', 'anthropic-ratelimit-input-tokens-limit': '20000', 'anthropic-ratelimit-input-tokens-remaining': '19000', 'anthropic-ratelimit-input-tokens-reset': '2025-05-26T04:56:42Z', 'anthropic-ratelimit-output-tokens-limit': '4000', 'anthropic-ratelimit-output-tokens-remaining': '4000', 'anthropic-ratelimit-output-tokens-reset': '2025-05-26T04:56:38Z', 'anthropic-ratelimit-requests-limit': '5', 'anthropic-ratelimit-requests-remaining': '0', 'anthropic-ratelimit-requests-reset': '2025-05-26T04:57:36Z', 'retry-after': '10', 'anthropic-ratelimit-tokens-limit': '24000', 'anthropic-ratelimit-tokens-remaining': '23000', 'anthropic-ratelimit-tokens-reset': '2025-05-26T04:56:38Z', 'request-id': 'req_011CPVYij5mqU5JVoiCRNtDp', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'anthropic-organization-id': '22e5ed16-15d8-4ef0-a72f-fd41275bf557', 'via': '1.1 google', 'cf-cache-status': 'DYNAMIC', 'x-robots-tag': 'none', 'server': 'cloudflare', 'cf-ray': '945aafe9ae07d1d9-ICN'})]
[2025-05-26 13:56:38,955][DEBUG][request_id: req_011CPVYij5mqU5JVoiCRNtDp]
[2025-05-26 13:56:38,955][DEBUG][Encountered httpx.HTTPStatusError]
Traceback (most recent call last):
  File "/Users/ranifarm/.conda/envs/adaptive-rag/lib/python3.11/site-packages/anthropic/_base_client.py", line 1065, in request
    response.raise_for_status()
  File "/Users/ranifarm/.conda/envs/adaptive-rag/lib/python3.11/site-packages/httpx/_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '429 Too Many Requests' for url 'https://api.anthropic.com/v1/messages'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429
[2025-05-26 13:56:38,959][DEBUG][Retrying as header `x-should-retry` is set to `true`]
[2025-05-26 13:56:38,959][DEBUG][2 retries left]
[2025-05-26 13:56:39,171][DEBUG][Sending compressed multipart request with context: trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=35a10c38-5b87-4389-9a10-caa8cd111178; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=9c0b64b5-5d45-414f-802f-6c5fc2bbbc72; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=9c0b64b5-5d45-414f-802f-6c5fc2bbbc72; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=c09d3098-690c-4034-840d-0e5a5035a3a7; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=25acc655-1aa4-41f8-b3bf-f98299fcc3c8; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=4b5dab4a-7034-4d9b-a846-f603fb47d2d8; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=4b5dab4a-7034-4d9b-a846-f603fb47d2d8; trace=d23b1f2d-0c44-43d7-8fa4-7788663989f7,id=1dd74f5b-c4e2-43bc-b6fe-9717e9f1f769]
[2025-05-26 13:56:39,379][DEBUG][https://api.smith.langchain.com:443 "POST /runs/multipart HTTP/1.1" 202 34]
[2025-05-26 13:56:48,965][DEBUG][Request options: {'method': 'post', 'url': '/v1/messages', 'files': None, 'idempotency_key': 'stainless-python-retry-36b52421-11ad-44f5-81e9-1084ae78d1f8', 'json_data': {'max_tokens': 1024, 'messages': [{'role': 'user', 'content': 'Retrieved document: \n\n page_content=\'하나의 적용단위로 판단할 때 업종판단은 가장 많은 비율을 차지\n하는 현업업무종사자의 업태와 유사한 업종을 기준으로 판단함\n- 2 -\' metadata={\'source\': \'/Users/ranifarm/python-work/adaptive-rag/vectorstore/data/지방자치단체 산안법 적용 (산재예방정책과-3018 (2018.07.06. 시행).pdf\', \'file_path\': \'/Users/ranifarm/python-work/adaptive-rag/vectorstore/data/지방자치단체 산안법 적용 (산재예방정책과-3018 (2018.07.06. 시행).pdf\', \'page\': 1, \'total_pages\': 3, \'Author\': \'dw\', \'CreationDate\': "D:20241223160641+09\'00\'", \'Creator\': \'Hwp 2022 12.0.0.2416\', \'ModDate\': "D:20241223160641+09\'00\'", \'PDFVersion\': \'1.4\', \'Producer\': \'Hancom PDF 1.3.0.545\'} \n\n User question: content=\'일상적인 인사와 대화 시작 표현들\' additional_kwargs={} response_metadata={\'id\': \'msg_01MLxrxAFTEFW6Hy1t3jDm62\', \'model\': \'claude-3-5-sonnet-20240620\', \'stop_reason\': \'end_turn\', \'stop_sequence\': None, \'usage\': {\'cache_creation_input_tokens\': 0, \'cache_read_input_tokens\': 0, \'input_tokens\': 405, \'output_tokens\': 22, \'server_tool_use\': None, \'service_tier\': \'standard\'}, \'model_name\': \'claude-3-5-sonnet-20240620\'} id=\'run--65989647-9bef-425f-b559-dab20f043d2e-0\' usage_metadata={\'input_tokens\': 405, \'output_tokens\': 22, \'total_tokens\': 427, \'input_token_details\': {\'cache_read\': 0, \'cache_creation\': 0}}'}], 'model': 'claude-3-5-sonnet-20240620', 'system': "채점자는 검색된 문서와 사용자 질문의 관련성을 평가하는 채점자입니다. \\n \n문서에 사용자 질문과 관련된 키워드 또는 의미론적 의미가 포함되어 있으면 관련성이 있는 것으로 채점합니다. \\n\n잘못된 검색을 걸러내는 것이 목표입니다. \\n\n문서가 질문으로 해결할 수 있는 내용인지 여부를 나타내는 이진 점수 'Y' 또는 'N'을 부여합니다.\n", 'temperature': 0.0, 'tool_choice': {'type': 'tool', 'name': 'GradeDocuments'}, 'tools': [{'name': 'GradeDocuments', 'input_schema': {'properties': {'pass_yn': {'description': "문서가 질문으로 해결 가능한 내용인지에 따라 'Y' 또는 'N' 로 답합니다.", 'enum': ['Y', 'N'], 'type': 'string'}}, 'required': ['pass_yn'], 'type': 'object'}, 'description': '검색된 문서가 질문으로 해결 가능한 내용인지에 대한 여부를 판단합니다.'}]}}]
[2025-05-26 13:56:48,966][DEBUG][Sending HTTP Request: POST https://api.anthropic.com/v1/messages]
[2025-05-26 13:56:48,966][DEBUG][close.started]
[2025-05-26 13:56:48,966][DEBUG][close.complete]
[2025-05-26 13:56:48,967][DEBUG][connect_tcp.started host='api.anthropic.com' port=443 local_address=None timeout=None socket_options=[(65535, 8, True), (6, 257, 60), (6, 258, 5)]]
[2025-05-26 13:56:48,980][DEBUG][connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x31d863b50>]
[2025-05-26 13:56:48,980][DEBUG][start_tls.started ssl_context=<ssl.SSLContext object at 0x30686b2f0> server_hostname='api.anthropic.com' timeout=None]
[2025-05-26 13:56:48,997][DEBUG][start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x31d863910>]
[2025-05-26 13:56:48,997][DEBUG][send_request_headers.started request=<Request [b'POST']>]
[2025-05-26 13:56:48,998][DEBUG][send_request_headers.complete]
[2025-05-26 13:56:48,998][DEBUG][send_request_body.started request=<Request [b'POST']>]
[2025-05-26 13:56:48,998][DEBUG][send_request_body.complete]
[2025-05-26 13:56:48,998][DEBUG][receive_response_headers.started request=<Request [b'POST']>]
[2025-05-26 13:56:49,988][DEBUG][receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 26 May 2025 04:56:49 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'anthropic-ratelimit-input-tokens-limit', b'20000'), (b'anthropic-ratelimit-input-tokens-remaining', b'19000'), (b'anthropic-ratelimit-input-tokens-reset', b'2025-05-26T04:56:53Z'), (b'anthropic-ratelimit-output-tokens-limit', b'4000'), (b'anthropic-ratelimit-output-tokens-remaining', b'4000'), (b'anthropic-ratelimit-output-tokens-reset', b'2025-05-26T04:56:49Z'), (b'anthropic-ratelimit-requests-limit', b'5'), (b'anthropic-ratelimit-requests-remaining', b'0'), (b'anthropic-ratelimit-requests-reset', b'2025-05-26T04:57:48Z'), (b'anthropic-ratelimit-tokens-limit', b'24000'), (b'anthropic-ratelimit-tokens-remaining', b'23000'), (b'anthropic-ratelimit-tokens-reset', b'2025-05-26T04:56:49Z'), (b'request-id', b'req_011CPVYjV2TZLkeNncUQgX7U'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'anthropic-organization-id', b'22e5ed16-15d8-4ef0-a72f-fd41275bf557'), (b'via', b'1.1 google'), (b'cf-cache-status', b'DYNAMIC'), (b'X-Robots-Tag', b'none'), (b'Server', b'cloudflare'), (b'CF-RAY', b'945ab02a3ad9d1eb-ICN'), (b'Content-Encoding', b'gzip')])]
[2025-05-26 13:56:49,990][DEBUG][receive_response_body.started request=<Request [b'POST']>]
[2025-05-26 13:56:49,995][DEBUG][receive_response_body.complete]
[2025-05-26 13:56:49,995][DEBUG][response_closed.started]
[2025-05-26 13:56:50,005][DEBUG][response_closed.complete]
[2025-05-26 13:56:50,006][DEBUG][HTTP Response: POST https://api.anthropic.com/v1/messages "200 OK" Headers({'date': 'Mon, 26 May 2025 04:56:49 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'anthropic-ratelimit-input-tokens-limit': '20000', 'anthropic-ratelimit-input-tokens-remaining': '19000', 'anthropic-ratelimit-input-tokens-reset': '2025-05-26T04:56:53Z', 'anthropic-ratelimit-output-tokens-limit': '4000', 'anthropic-ratelimit-output-tokens-remaining': '4000', 'anthropic-ratelimit-output-tokens-reset': '2025-05-26T04:56:49Z', 'anthropic-ratelimit-requests-limit': '5', 'anthropic-ratelimit-requests-remaining': '0', 'anthropic-ratelimit-requests-reset': '2025-05-26T04:57:48Z', 'anthropic-ratelimit-tokens-limit': '24000', 'anthropic-ratelimit-tokens-remaining': '23000', 'anthropic-ratelimit-tokens-reset': '2025-05-26T04:56:49Z', 'request-id': 'req_011CPVYjV2TZLkeNncUQgX7U', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'anthropic-organization-id': '22e5ed16-15d8-4ef0-a72f-fd41275bf557', 'via': '1.1 google', 'cf-cache-status': 'DYNAMIC', 'x-robots-tag': 'none', 'server': 'cloudflare', 'cf-ray': '945ab02a3ad9d1eb-ICN', 'content-encoding': 'gzip'})]
[2025-05-26 13:56:50,006][DEBUG][request_id: req_011CPVYjV2TZLkeNncUQgX7U]
[2025-05-26 13:56:50,024][DEBUG][Request options: {'method': 'post', 'url': '/v1/messages', 'files': None, 'idempotency_key': 'stainless-python-retry-d8401361-f5e9-434e-b057-d32e04ff4e59', 'json_data': {'max_tokens': 1024, 'messages': [{'role': 'user', 'content': 'Retrieved document: \n\n page_content=\'□ 질의내용별 회신\n1. 지방자치단체와 근로계약을 체결한 근로자가 수행하는 업무가 국가\n또는 지방자치단체의 목적 사업 중의 하나로서 일반행정에 관한 규\n제와 집행사무가 아닌 시설물·장비유지관리, 현장공사, 현장지도 단\n속·감시 등 현업업무를 수행한다면 공공행정으로 판단하지 않고 현\n업의 업종으로 판단하여 산안법을 전부 적용할 수 있는지?\n○ 일반 행정사무와 근로형태나 노무관리가 명확히 구분되는 시설물·\n장비유지관리, 현장공사, 현장지도 단속·감시 등 현업업무는 별도로\' metadata={\'source\': \'/Users/ranifarm/python-work/adaptive-rag/vectorstore/data/지방자치단체 산안법 적용 (산재예방정책과-3018 (2018.07.06. 시행).pdf\', \'file_path\': \'/Users/ranifarm/python-work/adaptive-rag/vectorstore/data/지방자치단체 산안법 적용 (산재예방정책과-3018 (2018.07.06. 시행).pdf\', \'page\': 2, \'total_pages\': 3, \'Author\': \'dw\', \'CreationDate\': "D:20241223160641+09\'00\'", \'Creator\': \'Hwp 2022 12.0.0.2416\', \'ModDate\': "D:20241223160641+09\'00\'", \'PDFVersion\': \'1.4\', \'Producer\': \'Hancom PDF 1.3.0.545\'} \n\n User question: content=\'일상적인 인사와 대화 시작 표현들\' additional_kwargs={} response_metadata={\'id\': \'msg_01MLxrxAFTEFW6Hy1t3jDm62\', \'model\': \'claude-3-5-sonnet-20240620\', \'stop_reason\': \'end_turn\', \'stop_sequence\': None, \'usage\': {\'cache_creation_input_tokens\': 0, \'cache_read_input_tokens\': 0, \'input_tokens\': 405, \'output_tokens\': 22, \'server_tool_use\': None, \'service_tier\': \'standard\'}, \'model_name\': \'claude-3-5-sonnet-20240620\'} id=\'run--65989647-9bef-425f-b559-dab20f043d2e-0\' usage_metadata={\'input_tokens\': 405, \'output_tokens\': 22, \'total_tokens\': 427, \'input_token_details\': {\'cache_read\': 0, \'cache_creation\': 0}}'}], 'model': 'claude-3-5-sonnet-20240620', 'system': "채점자는 검색된 문서와 사용자 질문의 관련성을 평가하는 채점자입니다. \\n \n문서에 사용자 질문과 관련된 키워드 또는 의미론적 의미가 포함되어 있으면 관련성이 있는 것으로 채점합니다. \\n\n잘못된 검색을 걸러내는 것이 목표입니다. \\n\n문서가 질문으로 해결할 수 있는 내용인지 여부를 나타내는 이진 점수 'Y' 또는 'N'을 부여합니다.\n", 'temperature': 0.0, 'tool_choice': {'type': 'tool', 'name': 'GradeDocuments'}, 'tools': [{'name': 'GradeDocuments', 'input_schema': {'properties': {'pass_yn': {'description': "문서가 질문으로 해결 가능한 내용인지에 따라 'Y' 또는 'N' 로 답합니다.", 'enum': ['Y', 'N'], 'type': 'string'}}, 'required': ['pass_yn'], 'type': 'object'}, 'description': '검색된 문서가 질문으로 해결 가능한 내용인지에 대한 여부를 판단합니다.'}]}}]
[2025-05-26 13:56:50,024][DEBUG][Sending HTTP Request: POST https://api.anthropic.com/v1/messages]
[2025-05-26 13:56:50,025][DEBUG][connect_tcp.started host='api.anthropic.com' port=443 local_address=None timeout=None socket_options=[(65535, 8, True), (6, 257, 60), (6, 258, 5)]]
[2025-05-26 13:56:50,036][DEBUG][connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x31d8ab550>]
[2025-05-26 13:56:50,036][DEBUG][start_tls.started ssl_context=<ssl.SSLContext object at 0x30686ba40> server_hostname='api.anthropic.com' timeout=None]
[2025-05-26 13:56:50,049][DEBUG][start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x31d8ab450>]
[2025-05-26 13:56:50,049][DEBUG][send_request_headers.started request=<Request [b'POST']>]
[2025-05-26 13:56:50,049][DEBUG][send_request_headers.complete]
[2025-05-26 13:56:50,050][DEBUG][send_request_body.started request=<Request [b'POST']>]
[2025-05-26 13:56:50,050][DEBUG][send_request_body.complete]
[2025-05-26 13:56:50,050][DEBUG][receive_response_headers.started request=<Request [b'POST']>]
[2025-05-26 14:13:02,055][DEBUG][Starting new HTTPS connection (1): api.smith.langchain.com:443]
[2025-05-26 14:13:02,118][DEBUG][Request options: {'method': 'post', 'url': '/v1/messages', 'files': None, 'idempotency_key': 'stainless-python-retry-9b12842d-9beb-4c23-a5c2-fac32875e8c2', 'json_data': {'max_tokens': 1024, 'messages': [{'role': 'user', 'content': '안녕하세요'}], 'model': 'claude-3-5-sonnet-20240620', 'system': "당신은 사용자 질문을 vector(벡터) 또는 search(웹 검색) 또는 generate(답변 생성)으로 라우팅하는 전문가입니다.\n- vector에는 '지방자치단체의 산안법 적용'과 관련된 문서가 포함되어 있습니다．이러한 주제에 대한 질문은 vector(벡터)를 routing하세요.\n- 일상적인 질문을 하는 경우, generate(답변 생성)으로 routing하세요.\n- 이 외의 검색이 필요한 질문의 경우, search(웹 검색)으로 routing하세요.\n", 'temperature': 0.0, 'tool_choice': {'type': 'tool', 'name': 'RouteQuery'}, 'tools': [{'name': 'RouteQuery', 'input_schema': {'properties': {'next_node': {'description': 'web_search/retrieve/generate 노드로 갈 지 질문을 보고 선택합니다.', 'enum': ['search', 'vector', 'generate'], 'type': 'string'}}, 'required': ['next_node'], 'type': 'object'}, 'description': '질문을 보고 가장 적합한 노드로 이동시킵니다.'}]}}]
[2025-05-26 14:13:02,118][DEBUG][Sending HTTP Request: POST https://api.anthropic.com/v1/messages]
[2025-05-26 14:13:02,119][DEBUG][connect_tcp.started host='api.anthropic.com' port=443 local_address=None timeout=None socket_options=[(65535, 8, True), (6, 257, 60), (6, 258, 5)]]
[2025-05-26 14:13:02,151][DEBUG][connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x12a28f310>]
[2025-05-26 14:13:02,151][DEBUG][start_tls.started ssl_context=<ssl.SSLContext object at 0x12a318050> server_hostname='api.anthropic.com' timeout=None]
[2025-05-26 14:13:02,171][DEBUG][start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x12a209710>]
[2025-05-26 14:13:02,171][DEBUG][send_request_headers.started request=<Request [b'POST']>]
[2025-05-26 14:13:02,172][DEBUG][send_request_headers.complete]
[2025-05-26 14:13:02,172][DEBUG][send_request_body.started request=<Request [b'POST']>]
[2025-05-26 14:13:02,172][DEBUG][send_request_body.complete]
[2025-05-26 14:13:02,172][DEBUG][receive_response_headers.started request=<Request [b'POST']>]
[2025-05-26 14:13:02,286][DEBUG][https://api.smith.langchain.com:443 "GET /info HTTP/1.1" 200 709]
[2025-05-26 14:13:02,343][DEBUG][Sending multipart request with context: trace=eee81a9a-ed65-4f90-8a66-b4e51ce6d736,id=eee81a9a-ed65-4f90-8a66-b4e51ce6d736; trace=eee81a9a-ed65-4f90-8a66-b4e51ce6d736,id=42a2abbc-68f6-43a1-b4f7-e486c2666e47; trace=eee81a9a-ed65-4f90-8a66-b4e51ce6d736,id=61aa53d5-fb17-45e7-9a4b-6cc15a65e8c1; trace=eee81a9a-ed65-4f90-8a66-b4e51ce6d736,id=010f9e5f-c154-4108-a9fd-530ab1ee4c1a; trace=eee81a9a-ed65-4f90-8a66-b4e51ce6d736,id=014a008d-c67c-4866-8ff6-3e6531747abc; trace=eee81a9a-ed65-4f90-8a66-b4e51ce6d736,id=bf64fbc9-af17-4032-8d75-cffe9ce3dd0b]
[2025-05-26 14:13:02,581][DEBUG][https://api.smith.langchain.com:443 "POST /runs/multipart HTTP/1.1" 202 34]
[2025-05-26 14:13:03,113][DEBUG][receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 26 May 2025 05:13:03 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'anthropic-ratelimit-input-tokens-limit', b'20000'), (b'anthropic-ratelimit-input-tokens-remaining', b'19000'), (b'anthropic-ratelimit-input-tokens-reset', b'2025-05-26T05:13:04Z'), (b'anthropic-ratelimit-output-tokens-limit', b'4000'), (b'anthropic-ratelimit-output-tokens-remaining', b'4000'), (b'anthropic-ratelimit-output-tokens-reset', b'2025-05-26T05:13:03Z'), (b'anthropic-ratelimit-requests-limit', b'5'), (b'anthropic-ratelimit-requests-remaining', b'4'), (b'anthropic-ratelimit-requests-reset', b'2025-05-26T05:13:14Z'), (b'anthropic-ratelimit-tokens-limit', b'24000'), (b'anthropic-ratelimit-tokens-remaining', b'23000'), (b'anthropic-ratelimit-tokens-reset', b'2025-05-26T05:13:03Z'), (b'request-id', b'req_011CPVZyDvcxSGw5gvja38HL'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'anthropic-organization-id', b'22e5ed16-15d8-4ef0-a72f-fd41275bf557'), (b'via', b'1.1 google'), (b'cf-cache-status', b'DYNAMIC'), (b'X-Robots-Tag', b'none'), (b'Server', b'cloudflare'), (b'CF-RAY', b'945ac7eccc13d1d7-ICN'), (b'Content-Encoding', b'gzip')])]
[2025-05-26 14:13:03,113][DEBUG][receive_response_body.started request=<Request [b'POST']>]
[2025-05-26 14:13:03,114][DEBUG][receive_response_body.complete]
[2025-05-26 14:13:03,114][DEBUG][response_closed.started]
[2025-05-26 14:13:03,114][DEBUG][response_closed.complete]
[2025-05-26 14:13:03,114][DEBUG][HTTP Response: POST https://api.anthropic.com/v1/messages "200 OK" Headers({'date': 'Mon, 26 May 2025 05:13:03 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'anthropic-ratelimit-input-tokens-limit': '20000', 'anthropic-ratelimit-input-tokens-remaining': '19000', 'anthropic-ratelimit-input-tokens-reset': '2025-05-26T05:13:04Z', 'anthropic-ratelimit-output-tokens-limit': '4000', 'anthropic-ratelimit-output-tokens-remaining': '4000', 'anthropic-ratelimit-output-tokens-reset': '2025-05-26T05:13:03Z', 'anthropic-ratelimit-requests-limit': '5', 'anthropic-ratelimit-requests-remaining': '4', 'anthropic-ratelimit-requests-reset': '2025-05-26T05:13:14Z', 'anthropic-ratelimit-tokens-limit': '24000', 'anthropic-ratelimit-tokens-remaining': '23000', 'anthropic-ratelimit-tokens-reset': '2025-05-26T05:13:03Z', 'request-id': 'req_011CPVZyDvcxSGw5gvja38HL', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'anthropic-organization-id': '22e5ed16-15d8-4ef0-a72f-fd41275bf557', 'via': '1.1 google', 'cf-cache-status': 'DYNAMIC', 'x-robots-tag': 'none', 'server': 'cloudflare', 'cf-ray': '945ac7eccc13d1d7-ICN', 'content-encoding': 'gzip'})]
[2025-05-26 14:13:03,114][DEBUG][request_id: req_011CPVZyDvcxSGw5gvja38HL]
[2025-05-26 14:13:03,137][DEBUG][Request options: {'method': 'post', 'url': '/v1/messages', 'files': None, 'idempotency_key': 'stainless-python-retry-d3c682d3-9425-4376-a00e-ae833b2de2e6', 'json_data': {'max_tokens': 1024, 'messages': [{'role': 'user', 'content': '당신은 질문-응답(QA) 작업을 전문으로 하는 AI 어시스턴트입니다. \n여러분의 주요 임무는 제공된 context 또는 채팅 기록을 기반으로 질문에 답변하는 것입니다.\n추가적인 내레이션 없이 간결하고 질문에 직접적으로 답변해야 합니다.\n\n###\n\n최종 답변은 간결하게 작성하되 중요한 숫자 값, 기술 용어, 전문 용어 및 이름을 포함해야 하며, 그 뒤에 정보의 출처를 적어야 합니다.\n\n# 단계\n\n1. 제공된 문맥을 주의 깊게 읽고 이해합니다.\n2. 문맥 내에서 질문과 관련된 핵심 정보를 파악합니다.\n3. 관련 정보를 바탕으로 간결하게 답안을 작성합니다.\n4. 최종 답변이 질문과 직접적으로 관련이 있는지 확인합니다.\n5. 답변의 출처를 글머리 기호로 나열하며, 파일 이름(페이지 번호 포함) 또는 문맥에 따른 URL이어야 합니다. 소스를 찾을 수 없는 경우 생략합니다.\n\n# 출력 형식:\n[최종 답안, 여기에 숫자 값, 전문 용어, 전문 용어 및 이름을 원래 언어로 입력]\n\n**출처**(선택 사항)\n- (답변의 출처는 문맥에서 파일 이름(페이지 번호 포함) 또는 URL이어야 합니다. 답안의 출처를 찾을 수 없는 경우 생략).\n- (출처가 여러 개 있는 경우 더 나열)\n- ...\n\n###\n\n기억하세요:\n- 오직 **제공된 문맥**에 근거하여 답안을 작성하는 것이 중요합니다.\n- 주어진 자료에 없는 외부 지식이나 정보를 사용하지 마세요.\n- 답의 출처를 찾을 수 없는 경우 "죄송합니다. 다른 질문을 해주세요." 답해야 합니다.\n- 단, 질문이 일상적인 대화인 경우 답해줘도 괜찮습니다. (예시: 안녕, 누구세요, 반가워 등)\n\n\n###\n\n# 다음은 여러분이 답해야 하는 사용자의 질문입니다:\n안녕하세요\n\n# 다음은 질문에 답변할 때 사용해야 하는 컨텍스트입니다:\n\n\n# 사용자의 질문에 대한 최종 답변입니다:\n'}], 'model': 'claude-3-5-sonnet-20240620', 'temperature': 0.0}}]
[2025-05-26 14:13:03,138][DEBUG][Sending HTTP Request: POST https://api.anthropic.com/v1/messages]
[2025-05-26 14:13:03,138][DEBUG][connect_tcp.started host='api.anthropic.com' port=443 local_address=None timeout=None socket_options=[(65535, 8, True), (6, 257, 60), (6, 258, 5)]]
[2025-05-26 14:13:03,148][DEBUG][connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x12a35afd0>]
[2025-05-26 14:13:03,148][DEBUG][start_tls.started ssl_context=<ssl.SSLContext object at 0x12a318c20> server_hostname='api.anthropic.com' timeout=None]
[2025-05-26 14:13:03,159][DEBUG][start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x12a275e10>]
[2025-05-26 14:13:03,159][DEBUG][send_request_headers.started request=<Request [b'POST']>]
[2025-05-26 14:13:03,159][DEBUG][send_request_headers.complete]
[2025-05-26 14:13:03,159][DEBUG][send_request_body.started request=<Request [b'POST']>]
[2025-05-26 14:13:03,160][DEBUG][send_request_body.complete]
[2025-05-26 14:13:03,160][DEBUG][receive_response_headers.started request=<Request [b'POST']>]
[2025-05-26 14:13:03,659][DEBUG][Sending compressed multipart request with context: trace=eee81a9a-ed65-4f90-8a66-b4e51ce6d736,id=bf64fbc9-af17-4032-8d75-cffe9ce3dd0b; trace=eee81a9a-ed65-4f90-8a66-b4e51ce6d736,id=79b190e7-ade5-4863-8952-3906e84d14cb; trace=eee81a9a-ed65-4f90-8a66-b4e51ce6d736,id=79b190e7-ade5-4863-8952-3906e84d14cb; trace=eee81a9a-ed65-4f90-8a66-b4e51ce6d736,id=010f9e5f-c154-4108-a9fd-530ab1ee4c1a; trace=eee81a9a-ed65-4f90-8a66-b4e51ce6d736,id=61aa53d5-fb17-45e7-9a4b-6cc15a65e8c1; trace=eee81a9a-ed65-4f90-8a66-b4e51ce6d736,id=42a2abbc-68f6-43a1-b4f7-e486c2666e47; trace=eee81a9a-ed65-4f90-8a66-b4e51ce6d736,id=1cf6ac9c-a271-478f-8282-72d6f1faf668; trace=eee81a9a-ed65-4f90-8a66-b4e51ce6d736,id=0174a749-db60-480d-a5cf-19ed6319c35a; trace=eee81a9a-ed65-4f90-8a66-b4e51ce6d736,id=3ede2f72-df5d-42b7-b3fa-6808a99688ef; trace=eee81a9a-ed65-4f90-8a66-b4e51ce6d736,id=3ede2f72-df5d-42b7-b3fa-6808a99688ef; trace=eee81a9a-ed65-4f90-8a66-b4e51ce6d736,id=cb9c0482-91b0-4990-8f08-01ff1e6d9aa8]
[2025-05-26 14:13:03,903][DEBUG][https://api.smith.langchain.com:443 "POST /runs/multipart HTTP/1.1" 202 34]
[2025-05-26 14:13:04,044][DEBUG][receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 26 May 2025 05:13:04 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'anthropic-ratelimit-input-tokens-limit', b'20000'), (b'anthropic-ratelimit-input-tokens-remaining', b'19000'), (b'anthropic-ratelimit-input-tokens-reset', b'2025-05-26T05:13:07Z'), (b'anthropic-ratelimit-output-tokens-limit', b'4000'), (b'anthropic-ratelimit-output-tokens-remaining', b'4000'), (b'anthropic-ratelimit-output-tokens-reset', b'2025-05-26T05:13:03Z'), (b'anthropic-ratelimit-requests-limit', b'5'), (b'anthropic-ratelimit-requests-remaining', b'3'), (b'anthropic-ratelimit-requests-reset', b'2025-05-26T05:13:26Z'), (b'anthropic-ratelimit-tokens-limit', b'24000'), (b'anthropic-ratelimit-tokens-remaining', b'23000'), (b'anthropic-ratelimit-tokens-reset', b'2025-05-26T05:13:03Z'), (b'request-id', b'req_011CPVZyJ9cyvURKKhHeZqTy'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'anthropic-organization-id', b'22e5ed16-15d8-4ef0-a72f-fd41275bf557'), (b'via', b'1.1 google'), (b'cf-cache-status', b'DYNAMIC'), (b'X-Robots-Tag', b'none'), (b'Server', b'cloudflare'), (b'CF-RAY', b'945ac7f2fe1cea04-ICN'), (b'Content-Encoding', b'gzip')])]
[2025-05-26 14:13:04,045][DEBUG][receive_response_body.started request=<Request [b'POST']>]
[2025-05-26 14:13:04,046][DEBUG][receive_response_body.complete]
[2025-05-26 14:13:04,046][DEBUG][response_closed.started]
[2025-05-26 14:13:04,046][DEBUG][response_closed.complete]
[2025-05-26 14:13:04,047][DEBUG][HTTP Response: POST https://api.anthropic.com/v1/messages "200 OK" Headers({'date': 'Mon, 26 May 2025 05:13:04 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'anthropic-ratelimit-input-tokens-limit': '20000', 'anthropic-ratelimit-input-tokens-remaining': '19000', 'anthropic-ratelimit-input-tokens-reset': '2025-05-26T05:13:07Z', 'anthropic-ratelimit-output-tokens-limit': '4000', 'anthropic-ratelimit-output-tokens-remaining': '4000', 'anthropic-ratelimit-output-tokens-reset': '2025-05-26T05:13:03Z', 'anthropic-ratelimit-requests-limit': '5', 'anthropic-ratelimit-requests-remaining': '3', 'anthropic-ratelimit-requests-reset': '2025-05-26T05:13:26Z', 'anthropic-ratelimit-tokens-limit': '24000', 'anthropic-ratelimit-tokens-remaining': '23000', 'anthropic-ratelimit-tokens-reset': '2025-05-26T05:13:03Z', 'request-id': 'req_011CPVZyJ9cyvURKKhHeZqTy', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'anthropic-organization-id': '22e5ed16-15d8-4ef0-a72f-fd41275bf557', 'via': '1.1 google', 'cf-cache-status': 'DYNAMIC', 'x-robots-tag': 'none', 'server': 'cloudflare', 'cf-ray': '945ac7f2fe1cea04-ICN', 'content-encoding': 'gzip'})]
[2025-05-26 14:13:04,047][DEBUG][request_id: req_011CPVZyJ9cyvURKKhHeZqTy]
[2025-05-26 14:13:04,060][DEBUG][close.started]
[2025-05-26 14:13:04,060][DEBUG][close.complete]
[2025-05-26 14:13:04,077][DEBUG][Request options: {'method': 'post', 'url': '/v1/messages', 'files': None, 'idempotency_key': 'stainless-python-retry-9eea8086-17d1-4d95-9a2a-c0c484c5f54f', 'json_data': {'max_tokens': 1024, 'messages': [{'role': 'user', 'content': 'Set of facts: \n\n  \n\n LLM generation: 안녕하세요. 무엇을 도와드릴까요?'}], 'model': 'claude-3-5-sonnet-20240620', 'system': "채점자는 생성된 LLM 답변이 검색된 일련의 사실에 근거/지원되는지 평가하는 채점자입니다. \\n \n'Y' 또는 'N'으로 이진 점수를 부여합니다. 'Y'는 답변이 일련의 사실에 근거하거나 사실에 의해 뒷받침된다는 의미입니다.\n", 'temperature': 0.0, 'tool_choice': {'type': 'tool', 'name': 'GradeHallucinations'}, 'tools': [{'name': 'GradeHallucinations', 'input_schema': {'properties': {'pass_yn': {'description': "생성된 답변이 사실인지에 따라 'Y' 또는 'N' 로 답합니다.", 'enum': ['Y', 'N'], 'type': 'string'}}, 'required': ['pass_yn'], 'type': 'object'}, 'description': '생성된 답변이 hallucination 현상이 있는지에 대한 여부를 판단합니다. '}]}}]
[2025-05-26 14:13:04,078][DEBUG][Sending HTTP Request: POST https://api.anthropic.com/v1/messages]
[2025-05-26 14:13:04,078][DEBUG][connect_tcp.started host='api.anthropic.com' port=443 local_address=None timeout=None socket_options=[(65535, 8, True), (6, 257, 60), (6, 258, 5)]]
[2025-05-26 14:13:04,093][DEBUG][connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x12a3687d0>]
[2025-05-26 14:13:04,093][DEBUG][start_tls.started ssl_context=<ssl.SSLContext object at 0x12a3189e0> server_hostname='api.anthropic.com' timeout=None]
[2025-05-26 14:13:04,111][DEBUG][start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x12a369110>]
[2025-05-26 14:13:04,112][DEBUG][send_request_headers.started request=<Request [b'POST']>]
[2025-05-26 14:13:04,112][DEBUG][send_request_headers.complete]
[2025-05-26 14:13:04,112][DEBUG][send_request_body.started request=<Request [b'POST']>]
[2025-05-26 14:13:04,112][DEBUG][send_request_body.complete]
[2025-05-26 14:13:04,112][DEBUG][receive_response_headers.started request=<Request [b'POST']>]
[2025-05-26 14:13:04,602][DEBUG][Sending compressed multipart request with context: trace=eee81a9a-ed65-4f90-8a66-b4e51ce6d736,id=cb9c0482-91b0-4990-8f08-01ff1e6d9aa8; trace=eee81a9a-ed65-4f90-8a66-b4e51ce6d736,id=16f64fe8-7d49-4845-b977-6c3470c36632; trace=eee81a9a-ed65-4f90-8a66-b4e51ce6d736,id=16f64fe8-7d49-4845-b977-6c3470c36632; trace=eee81a9a-ed65-4f90-8a66-b4e51ce6d736,id=0174a749-db60-480d-a5cf-19ed6319c35a; trace=eee81a9a-ed65-4f90-8a66-b4e51ce6d736,id=d651e913-09a7-4f64-b6ae-d05d2f0301ed; trace=eee81a9a-ed65-4f90-8a66-b4e51ce6d736,id=29d0b3c2-af59-4ae8-b983-d3f55d004e76; trace=eee81a9a-ed65-4f90-8a66-b4e51ce6d736,id=8990b7b4-dcb8-4dd2-b0f7-3fd41ee32693; trace=eee81a9a-ed65-4f90-8a66-b4e51ce6d736,id=8990b7b4-dcb8-4dd2-b0f7-3fd41ee32693; trace=eee81a9a-ed65-4f90-8a66-b4e51ce6d736,id=a393a31c-b0a3-4685-83aa-d20555c71987]
[2025-05-26 14:13:04,828][DEBUG][https://api.smith.langchain.com:443 "POST /runs/multipart HTTP/1.1" 202 34]
[2025-05-26 14:13:05,120][DEBUG][receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 26 May 2025 05:13:05 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'anthropic-ratelimit-input-tokens-limit', b'20000'), (b'anthropic-ratelimit-input-tokens-remaining', b'18000'), (b'anthropic-ratelimit-input-tokens-reset', b'2025-05-26T05:13:09Z'), (b'anthropic-ratelimit-output-tokens-limit', b'4000'), (b'anthropic-ratelimit-output-tokens-remaining', b'4000'), (b'anthropic-ratelimit-output-tokens-reset', b'2025-05-26T05:13:05Z'), (b'anthropic-ratelimit-requests-limit', b'5'), (b'anthropic-ratelimit-requests-remaining', b'2'), (b'anthropic-ratelimit-requests-reset', b'2025-05-26T05:13:38Z'), (b'anthropic-ratelimit-tokens-limit', b'24000'), (b'anthropic-ratelimit-tokens-remaining', b'22000'), (b'anthropic-ratelimit-tokens-reset', b'2025-05-26T05:13:05Z'), (b'request-id', b'req_011CPVZyNEwGJT7LXx3n3XEk'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'anthropic-organization-id', b'22e5ed16-15d8-4ef0-a72f-fd41275bf557'), (b'via', b'1.1 google'), (b'cf-cache-status', b'DYNAMIC'), (b'X-Robots-Tag', b'none'), (b'Server', b'cloudflare'), (b'CF-RAY', b'945ac7f8ef5aea2d-ICN'), (b'Content-Encoding', b'gzip')])]
[2025-05-26 14:13:05,123][DEBUG][receive_response_body.started request=<Request [b'POST']>]
[2025-05-26 14:13:05,123][DEBUG][receive_response_body.complete]
[2025-05-26 14:13:05,123][DEBUG][response_closed.started]
[2025-05-26 14:13:05,123][DEBUG][response_closed.complete]
[2025-05-26 14:13:05,124][DEBUG][HTTP Response: POST https://api.anthropic.com/v1/messages "200 OK" Headers({'date': 'Mon, 26 May 2025 05:13:05 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'anthropic-ratelimit-input-tokens-limit': '20000', 'anthropic-ratelimit-input-tokens-remaining': '18000', 'anthropic-ratelimit-input-tokens-reset': '2025-05-26T05:13:09Z', 'anthropic-ratelimit-output-tokens-limit': '4000', 'anthropic-ratelimit-output-tokens-remaining': '4000', 'anthropic-ratelimit-output-tokens-reset': '2025-05-26T05:13:05Z', 'anthropic-ratelimit-requests-limit': '5', 'anthropic-ratelimit-requests-remaining': '2', 'anthropic-ratelimit-requests-reset': '2025-05-26T05:13:38Z', 'anthropic-ratelimit-tokens-limit': '24000', 'anthropic-ratelimit-tokens-remaining': '22000', 'anthropic-ratelimit-tokens-reset': '2025-05-26T05:13:05Z', 'request-id': 'req_011CPVZyNEwGJT7LXx3n3XEk', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'anthropic-organization-id': '22e5ed16-15d8-4ef0-a72f-fd41275bf557', 'via': '1.1 google', 'cf-cache-status': 'DYNAMIC', 'x-robots-tag': 'none', 'server': 'cloudflare', 'cf-ray': '945ac7f8ef5aea2d-ICN', 'content-encoding': 'gzip'})]
[2025-05-26 14:13:05,124][DEBUG][request_id: req_011CPVZyNEwGJT7LXx3n3XEk]
[2025-05-26 14:13:05,153][DEBUG][Request options: {'method': 'post', 'url': '/v1/messages', 'files': None, 'idempotency_key': 'stainless-python-retry-db50f3a5-37cd-41d1-94c7-c25619d43d2e', 'json_data': {'max_tokens': 1024, 'messages': [{'role': 'user', 'content': 'User question: \n\n 안녕하세요 \n\n LLM generation: 안녕하세요. 무엇을 도와드릴까요?'}], 'model': 'claude-3-5-sonnet-20240620', 'system': "당신은 제공된 답변이 질문과 관련 있는지 평가하는 채점자입니다.\n'Y' 또는 'N'로 이진 점수를 부여합니다. \n답변이 질문과 관련이 있으면 'Y'를 부여하고 관련이 없으면 'N'을 부여하세요.\n 제공된 답변이 '정보를 찾을 수 없다는' 의미의 답변이라면 'Y'를 부여하세요.\n", 'temperature': 0.0, 'tool_choice': {'type': 'tool', 'name': 'GradeQuestionAnswer'}, 'tools': [{'name': 'GradeQuestionAnswer', 'input_schema': {'properties': {'pass_yn': {'description': "답변이 질문을 해결할 수 있는 지에 따라 'Y' 또는 'N' 로 답합니다.", 'enum': ['Y', 'N'], 'type': 'string'}}, 'required': ['pass_yn'], 'type': 'object'}, 'description': '생성된 답변이 질문과 관련이 있는지에 대한 여부를 판단합니다.'}]}}]
[2025-05-26 14:13:05,154][DEBUG][Sending HTTP Request: POST https://api.anthropic.com/v1/messages]
[2025-05-26 14:13:05,154][DEBUG][connect_tcp.started host='api.anthropic.com' port=443 local_address=None timeout=None socket_options=[(65535, 8, True), (6, 257, 60), (6, 258, 5)]]
[2025-05-26 14:13:05,165][DEBUG][connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x12a376a90>]
[2025-05-26 14:13:05,165][DEBUG][start_tls.started ssl_context=<ssl.SSLContext object at 0x12a3188c0> server_hostname='api.anthropic.com' timeout=None]
[2025-05-26 14:13:05,183][DEBUG][start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x12a376a50>]
[2025-05-26 14:13:05,183][DEBUG][send_request_headers.started request=<Request [b'POST']>]
[2025-05-26 14:13:05,184][DEBUG][send_request_headers.complete]
[2025-05-26 14:13:05,184][DEBUG][send_request_body.started request=<Request [b'POST']>]
[2025-05-26 14:13:05,184][DEBUG][send_request_body.complete]
[2025-05-26 14:13:05,184][DEBUG][receive_response_headers.started request=<Request [b'POST']>]
[2025-05-26 14:13:05,672][DEBUG][Sending compressed multipart request with context: trace=eee81a9a-ed65-4f90-8a66-b4e51ce6d736,id=a393a31c-b0a3-4685-83aa-d20555c71987; trace=eee81a9a-ed65-4f90-8a66-b4e51ce6d736,id=5cc5bf9c-c778-48ce-90bd-dfcc4b6361f3; trace=eee81a9a-ed65-4f90-8a66-b4e51ce6d736,id=5cc5bf9c-c778-48ce-90bd-dfcc4b6361f3; trace=eee81a9a-ed65-4f90-8a66-b4e51ce6d736,id=29d0b3c2-af59-4ae8-b983-d3f55d004e76; trace=eee81a9a-ed65-4f90-8a66-b4e51ce6d736,id=8166fb14-61ae-4562-9df7-b5c2f213afea; trace=eee81a9a-ed65-4f90-8a66-b4e51ce6d736,id=ea231085-7cc0-4357-85ad-233b1cc386f1; trace=eee81a9a-ed65-4f90-8a66-b4e51ce6d736,id=ea231085-7cc0-4357-85ad-233b1cc386f1; trace=eee81a9a-ed65-4f90-8a66-b4e51ce6d736,id=f8808aac-35ed-4084-acde-10e354b74f8a]
[2025-05-26 14:13:05,673][DEBUG][close.started]
[2025-05-26 14:13:05,674][DEBUG][close.complete]
[2025-05-26 14:13:05,891][DEBUG][https://api.smith.langchain.com:443 "POST /runs/multipart HTTP/1.1" 202 34]
[2025-05-26 14:13:06,162][DEBUG][receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Mon, 26 May 2025 05:13:06 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'anthropic-ratelimit-input-tokens-limit', b'20000'), (b'anthropic-ratelimit-input-tokens-remaining', b'18000'), (b'anthropic-ratelimit-input-tokens-reset', b'2025-05-26T05:13:11Z'), (b'anthropic-ratelimit-output-tokens-limit', b'4000'), (b'anthropic-ratelimit-output-tokens-remaining', b'4000'), (b'anthropic-ratelimit-output-tokens-reset', b'2025-05-26T05:13:06Z'), (b'anthropic-ratelimit-requests-limit', b'5'), (b'anthropic-ratelimit-requests-remaining', b'1'), (b'anthropic-ratelimit-requests-reset', b'2025-05-26T05:13:50Z'), (b'anthropic-ratelimit-tokens-limit', b'24000'), (b'anthropic-ratelimit-tokens-remaining', b'22000'), (b'anthropic-ratelimit-tokens-reset', b'2025-05-26T05:13:06Z'), (b'request-id', b'req_011CPVZySp1xooWHdsN7kn7X'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'anthropic-organization-id', b'22e5ed16-15d8-4ef0-a72f-fd41275bf557'), (b'via', b'1.1 google'), (b'cf-cache-status', b'DYNAMIC'), (b'X-Robots-Tag', b'none'), (b'Server', b'cloudflare'), (b'CF-RAY', b'945ac7ff9a6b3091-ICN'), (b'Content-Encoding', b'gzip')])]
[2025-05-26 14:13:06,164][DEBUG][receive_response_body.started request=<Request [b'POST']>]
[2025-05-26 14:13:06,164][DEBUG][receive_response_body.complete]
[2025-05-26 14:13:06,164][DEBUG][response_closed.started]
[2025-05-26 14:13:06,164][DEBUG][response_closed.complete]
[2025-05-26 14:13:06,164][DEBUG][HTTP Response: POST https://api.anthropic.com/v1/messages "200 OK" Headers({'date': 'Mon, 26 May 2025 05:13:06 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'anthropic-ratelimit-input-tokens-limit': '20000', 'anthropic-ratelimit-input-tokens-remaining': '18000', 'anthropic-ratelimit-input-tokens-reset': '2025-05-26T05:13:11Z', 'anthropic-ratelimit-output-tokens-limit': '4000', 'anthropic-ratelimit-output-tokens-remaining': '4000', 'anthropic-ratelimit-output-tokens-reset': '2025-05-26T05:13:06Z', 'anthropic-ratelimit-requests-limit': '5', 'anthropic-ratelimit-requests-remaining': '1', 'anthropic-ratelimit-requests-reset': '2025-05-26T05:13:50Z', 'anthropic-ratelimit-tokens-limit': '24000', 'anthropic-ratelimit-tokens-remaining': '22000', 'anthropic-ratelimit-tokens-reset': '2025-05-26T05:13:06Z', 'request-id': 'req_011CPVZySp1xooWHdsN7kn7X', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'anthropic-organization-id': '22e5ed16-15d8-4ef0-a72f-fd41275bf557', 'via': '1.1 google', 'cf-cache-status': 'DYNAMIC', 'x-robots-tag': 'none', 'server': 'cloudflare', 'cf-ray': '945ac7ff9a6b3091-ICN', 'content-encoding': 'gzip'})]
[2025-05-26 14:13:06,165][DEBUG][request_id: req_011CPVZySp1xooWHdsN7kn7X]
[2025-05-26 14:13:06,712][DEBUG][Sending compressed multipart request with context: trace=eee81a9a-ed65-4f90-8a66-b4e51ce6d736,id=f8808aac-35ed-4084-acde-10e354b74f8a; trace=eee81a9a-ed65-4f90-8a66-b4e51ce6d736,id=31e191b5-1829-46d1-bed8-593ca172d8f6; trace=eee81a9a-ed65-4f90-8a66-b4e51ce6d736,id=31e191b5-1829-46d1-bed8-593ca172d8f6; trace=eee81a9a-ed65-4f90-8a66-b4e51ce6d736,id=8166fb14-61ae-4562-9df7-b5c2f213afea; trace=eee81a9a-ed65-4f90-8a66-b4e51ce6d736,id=d651e913-09a7-4f64-b6ae-d05d2f0301ed; trace=eee81a9a-ed65-4f90-8a66-b4e51ce6d736,id=1cf6ac9c-a271-478f-8282-72d6f1faf668; trace=eee81a9a-ed65-4f90-8a66-b4e51ce6d736,id=eee81a9a-ed65-4f90-8a66-b4e51ce6d736]
[2025-05-26 14:13:06,933][DEBUG][https://api.smith.langchain.com:443 "POST /runs/multipart HTTP/1.1" 202 34]
